import org.json.JSONObject;
import org.junit.FixMethodOrder;
import org.junit.Test;
import org.junit.runners.MethodSorters;
import org.soton.seg7.ad_analytics.model.DBHandler;
import org.soton.seg7.ad_analytics.model.DBQuery;
import org.soton.seg7.ad_analytics.model.exceptions.MongoAuthException;
import org.soton.seg7.ad_analytics.model.Parser;

import static org.junit.Assert.*;

import java.io.File;
import java.util.Map;

/**
 * Created by bogdanbuduroiu on 24/02/2017.
 */

@FixMethodOrder(MethodSorters.NAME_ASCENDING)
public class ParserTest {

    File clickFile = new File(new File("").getAbsolutePath().toString() + "/static/analytics_csv/click_log.csv");
    File impressionsFile = new File(new File("").getAbsolutePath().toString() + "/static/analytics_csv/impression_log.csv");
    File serverFile = new File(new File("").getAbsolutePath().toString() + "/static/analytics_csv/server_log.csv");

    @Test
    public void testClickLogValidator() {
        assertEquals(true, Parser.isValidClickLog(clickFile));
    }

    @Test
    public void testServerLogValidator() {
        assertEquals(true, Parser.isValidServerLog(serverFile));
    }

    @Test
    public void testImpressionLogValidator() {
        assertEquals(true, Parser.isValidImpressionLog(impressionsFile));
    }

    @Test
    public void testImpressionDayNum() {
        final Map<String, Object> expectedJsonMap = new JSONObject("{ \"2015-01-30\" : { \"00\" : 2954, \"11\" : 7168, \"22\" : 6461, \"01\" : 1157, \"12\" : 7414, \"23\" : 4437, \"02\" : 136, \"13\" : 7359, \"03\" : 137, \"14\" : 7417, \"04\" : 133, \"15\" : 7428, \"05\" : 846, \"16\" : 7267, \"06\" : 2320, \"17\" : 7338, \"07\" : 3747, \"18\" : 7364, \"08\" : 5371, \"19\" : 7328, \"09\" : 6769, \"20\" : 7245, \"10\" : 7297, \"21\" : 7155 }, \"2015-01-31\" : { \"00\" : 2814, \"11\" : 9847, \"22\" : 8221, \"01\" : 977, \"12\" : 9701, \"23\" : 5899, \"02\" : 117, \"13\" : 9680, \"03\" : 167, \"14\" : 9638, \"04\" : 156, \"15\" : 9603, \"05\" : 1123, \"16\" : 9709, \"06\" : 3222, \"17\" : 9735, \"07\" : 5224, \"18\" : 9512, \"08\" : 7002, \"19\" : 9413, \"09\" : 8858, \"20\" : 9508, \"10\" : 9791, \"21\" : 9474 }, \"2015-01-27\" : { \"00\" : 2838, \"11\" : 8629, \"22\" : 6151, \"01\" : 1016, \"12\" : 8290, \"23\" : 4380, \"02\" : 139, \"13\" : 8178, \"03\" : 97, \"14\" : 8029, \"04\" : 106, \"15\" : 7967, \"05\" : 999, \"16\" : 7885, \"06\" : 2759, \"17\" : 7566, \"07\" : 4290, \"18\" : 7544, \"08\" : 6161, \"19\" : 7420, \"09\" : 7987, \"20\" : 7330, \"10\" : 8724, \"21\" : 6979 }, \"2015-01-28\" : { \"00\" : 2683, \"11\" : 6786, \"22\" : 6995, \"01\" : 956, \"12\" : 6884, \"23\" : 4941, \"02\" : 149, \"13\" : 7253, \"03\" : 122, \"14\" : 7091, \"04\" : 111, \"15\" : 7191, \"05\" : 764, \"16\" : 7332, \"06\" : 2080, \"17\" : 7485, \"07\" : 3402, \"18\" : 7488, \"08\" : 4674, \"19\" : 7698, \"09\" : 5917, \"20\" : 7620, \"10\" : 6742, \"21\" : 7836 }, \"2015-01-25\" : { \"00\" : 2326, \"11\" : 5982, \"22\" : 7485, \"01\" : 894, \"12\" : 6279, \"23\" : 5272, \"02\" : 123, \"13\" : 6327, \"03\" : 93, \"14\" : 6537, \"04\" : 111, \"15\" : 6922, \"05\" : 647, \"16\" : 7148, \"06\" : 1709, \"17\" : 7346, \"07\" : 2781, \"18\" : 7568, \"08\" : 4052, \"19\" : 7743, \"09\" : 5251, \"20\" : 8099, \"10\" : 5778, \"21\" : 8145 }, \"2015-01-26\" : { \"00\" : 3131, \"11\" : 8095, \"22\" : 6242, \"01\" : 1194, \"12\" : 7855, \"23\" : 4604, \"02\" : 126, \"13\" : 7922, \"03\" : 140, \"14\" : 7863, \"04\" : 129, \"15\" : 7840, \"05\" : 914, \"16\" : 7661, \"06\" : 2568, \"17\" : 7547, \"07\" : 4171, \"18\" : 7314, \"08\" : 5760, \"19\" : 7521, \"09\" : 7468, \"20\" : 7303, \"10\" : 8188, \"21\" : 7256 }, \"2015-01-23\" : { \"00\" : 2740, \"11\" : 8404, \"22\" : 5514, \"01\" : 1013, \"12\" : 8014, \"23\" : 4026, \"02\" : 133, \"13\" : 7661, \"03\" : 147, \"14\" : 7631, \"04\" : 129, \"15\" : 7472, \"05\" : 931, \"16\" : 7505, \"06\" : 2643, \"17\" : 6978, \"07\" : 4417, \"18\" : 6997, \"08\" : 6069, \"19\" : 6801, \"09\" : 7656, \"20\" : 6600, \"10\" : 8610, \"21\" : 6390 }, \"2015-01-24\" : { \"00\" : 2430, \"11\" : 6940, \"22\" : 5194, \"01\" : 917, \"12\" : 6746, \"23\" : 3676, \"02\" : 115, \"13\" : 6936, \"03\" : 116, \"14\" : 6566, \"04\" : 126, \"15\" : 6477, \"05\" : 808, \"16\" : 6465, \"06\" : 2139, \"17\" : 6157, \"07\" : 3684, \"18\" : 6197, \"08\" : 5033, \"19\" : 6220, \"09\" : 6291, \"20\" : 5924, \"10\" : 7132, \"21\" : 5852 }, \"2015-01-21\" : { \"00\" : 2522, \"11\" : 7792, \"22\" : 7760, \"01\" : 989, \"12\" : 8003, \"23\" : 5629, \"02\" : 132, \"13\" : 7934, \"03\" : 105, \"14\" : 8001, \"04\" : 98, \"15\" : 8026, \"05\" : 836, \"16\" : 8245, \"06\" : 2411, \"17\" : 8337, \"07\" : 3882, \"18\" : 8512, \"08\" : 5314, \"19\" : 8801, \"09\" : 6821, \"20\" : 8839, \"10\" : 7601, \"21\" : 8702 }, \"2015-01-22\" : { \"00\" : 3398, \"11\" : 8960, \"22\" : 6115, \"01\" : 1188, \"12\" : 8521, \"23\" : 4418, \"02\" : 155, \"13\" : 8400, \"03\" : 144, \"14\" : 8059, \"04\" : 136, \"15\" : 8049, \"05\" : 961, \"16\" : 7866, \"06\" : 2755, \"17\" : 7791, \"07\" : 4600, \"18\" : 7395, \"08\" : 6508, \"19\" : 7396, \"09\" : 8120, \"20\" : 7306, \"10\" : 8952, \"21\" : 7068 }, \"2015-01-29\" : { \"00\" : 3131, \"11\" : 7030, \"22\" : 7046, \"01\" : 1091, \"12\" : 6945, \"23\" : 5164, \"02\" : 112, \"13\" : 7212, \"03\" : 131, \"14\" : 7322, \"04\" : 120, \"15\" : 7349, \"05\" : 796, \"16\" : 7192, \"06\" : 2101, \"17\" : 7408, \"07\" : 3429, \"18\" : 7603, \"08\" : 4753, \"19\" : 7748, \"09\" : 6070, \"20\" : 7932, \"10\" : 6805, \"21\" : 8019 }, \"2015-01-20\" : { \"00\" : 1913, \"11\" : 5139, \"22\" : 5659, \"01\" : 706, \"12\" : 5343, \"23\" : 4181, \"02\" : 111, \"13\" : 5405, \"03\" : 105, \"14\" : 5529, \"04\" : 117, \"15\" : 5709, \"05\" : 613, \"16\" : 5727, \"06\" : 1522, \"17\" : 6111, \"07\" : 2484, \"18\" : 6040, \"08\" : 3558, \"19\" : 6014, \"09\" : 4362, \"20\" : 6192, \"10\" : 5141, \"21\" : 6471 }, \"2015-01-16\" : { \"00\" : 2462, \"11\" : 5857, \"22\" : 6110, \"01\" : 901, \"12\" : 5917, \"23\" : 4433, \"02\" : 119, \"13\" : 6026, \"03\" : 130, \"14\" : 6157, \"04\" : 118, \"15\" : 6311, \"05\" : 727, \"16\" : 6494, \"06\" : 1783, \"17\" : 6551, \"07\" : 2851, \"18\" : 6676, \"08\" : 3970, \"19\" : 6869, \"09\" : 5238, \"20\" : 6710, \"10\" : 5749, \"21\" : 6906 }, \"2015-02-28\" : { \"00\" : 6342, \"11\" : 12850, \"01\" : 2370, \"12\" : 1, \"02\" : 263, \"03\" : 266, \"04\" : 186, \"05\" : 1455, \"06\" : 4064, \"07\" : 6678, \"08\" : 9007, \"09\" : 11645, \"10\" : 12738 }, \"2015-01-17\" : { \"00\" : 2623, \"11\" : 5503, \"22\" : 5322, \"01\" : 1016, \"12\" : 5590, \"23\" : 3817, \"02\" : 87, \"13\" : 5724, \"03\" : 118, \"14\" : 5806, \"04\" : 107, \"15\" : 5647, \"05\" : 625, \"16\" : 5796, \"06\" : 1765, \"17\" : 5770, \"07\" : 2784, \"18\" : 5955, \"08\" : 3963, \"19\" : 5982, \"09\" : 4927, \"20\" : 6009, \"10\" : 5578, \"21\" : 5997 }, \"2015-01-14\" : { \"00\" : 2267, \"11\" : 6916, \"22\" : 6384, \"01\" : 833, \"12\" : 6946, \"23\" : 4710, \"02\" : 107, \"13\" : 7223, \"03\" : 103, \"14\" : 6909, \"04\" : 118, \"15\" : 7110, \"05\" : 790, \"16\" : 7226, \"06\" : 2149, \"17\" : 7096, \"07\" : 3473, \"18\" : 7182, \"08\" : 4773, \"19\" : 7094, \"09\" : 6130, \"20\" : 7321, \"10\" : 6932, \"21\" : 7341 }, \"2015-02-26\" : { \"00\" : 6316, \"11\" : 14888, \"22\" : 10537, \"01\" : 2269, \"12\" : 14361, \"23\" : 7628, \"02\" : 219, \"13\" : 14010, \"03\" : 221, \"14\" : 13818, \"04\" : 174, \"15\" : 13861, \"05\" : 1680, \"16\" : 13283, \"06\" : 4641, \"17\" : 12939, \"07\" : 7665, \"18\" : 12897, \"08\" : 10671, \"19\" : 12694, \"09\" : 13485, \"20\" : 12142, \"10\" : 14970, \"21\" : 12204 }, \"2015-01-15\" : { \"00\" : 2751, \"11\" : 8122, \"22\" : 5566, \"01\" : 920, \"12\" : 7982, \"23\" : 3978, \"02\" : 115, \"13\" : 7902, \"03\" : 121, \"14\" : 7743, \"04\" : 131, \"15\" : 7645, \"05\" : 925, \"16\" : 7477, \"06\" : 2616, \"17\" : 7017, \"07\" : 4242, \"18\" : 6984, \"08\" : 5936, \"19\" : 6969, \"09\" : 7590, \"20\" : 6712, \"10\" : 8270, \"21\" : 6552 }, \"2015-02-27\" : { \"00\" : 4718, \"11\" : 12253, \"22\" : 14423, \"01\" : 1751, \"12\" : 12736, \"23\" : 10298, \"02\" : 234, \"13\" : 12977, \"03\" : 250, \"14\" : 13547, \"04\" : 264, \"15\" : 13779, \"05\" : 1356, \"16\" : 14270, \"06\" : 3633, \"17\" : 14547, \"07\" : 5986, \"18\" : 15158, \"08\" : 8027, \"19\" : 15573, \"09\" : 10506, \"20\" : 15857, \"10\" : 11822, \"21\" : 16435 }, \"2015-01-12\" : { \"00\" : 3849, \"11\" : 6905, \"22\" : 5516, \"01\" : 1325, \"12\" : 7064, \"23\" : 4089, \"02\" : 121, \"13\" : 7055, \"03\" : 127, \"14\" : 6924, \"04\" : 118, \"15\" : 6797, \"05\" : 847, \"16\" : 6702, \"06\" : 2247, \"17\" : 6588, \"07\" : 3672, \"18\" : 6601, \"08\" : 5125, \"19\" : 6509, \"09\" : 6425, \"20\" : 6589, \"10\" : 7307, \"21\" : 6500 }, \"2015-02-24\" : { \"00\" : 4980, \"11\" : 15009, \"22\" : 12180, \"01\" : 1831, \"12\" : 14576, \"23\" : 8650, \"02\" : 184, \"13\" : 14725, \"03\" : 193, \"14\" : 14698, \"04\" : 230, \"15\" : 14494, \"05\" : 1710, \"16\" : 14360, \"06\" : 4749, \"17\" : 14453, \"07\" : 7696, \"18\" : 14208, \"08\" : 10625, \"19\" : 14063, \"09\" : 13643, \"20\" : 14001, \"10\" : 15042, \"21\" : 13766 }, \"2015-01-13\" : { \"00\" : 2544, \"11\" : 7274, \"22\" : 5222, \"01\" : 824, \"12\" : 7234, \"23\" : 3766, \"02\" : 140, \"13\" : 7003, \"03\" : 124, \"14\" : 6876, \"04\" : 115, \"15\" : 6709, \"05\" : 843, \"16\" : 6529, \"06\" : 2309, \"17\" : 6612, \"07\" : 3764, \"18\" : 6506, \"08\" : 5359, \"19\" : 6122, \"09\" : 6664, \"20\" : 6233, \"10\" : 7489, \"21\" : 6030 }, \"2015-02-25\" : { \"00\" : 5225, \"11\" : 14568, \"22\" : 14405, \"01\" : 1872, \"12\" : 14893, \"23\" : 10216, \"02\" : 202, \"13\" : 15166, \"03\" : 208, \"14\" : 15091, \"04\" : 189, \"15\" : 15315, \"05\" : 1679, \"16\" : 15639, \"06\" : 4513, \"17\" : 15642, \"07\" : 7275, \"18\" : 15784, \"08\" : 9847, \"19\" : 16022, \"09\" : 13018, \"20\" : 16303, \"10\" : 14348, \"21\" : 16160 }, \"2015-01-10\" : { \"00\" : 2751, \"11\" : 7535, \"22\" : 6982, \"01\" : 1030, \"12\" : 7358, \"23\" : 4989, \"02\" : 126, \"13\" : 7543, \"03\" : 122, \"14\" : 7604, \"04\" : 122, \"15\" : 7548, \"05\" : 810, \"16\" : 7614, \"06\" : 2266, \"17\" : 7611, \"07\" : 3837, \"18\" : 7727, \"08\" : 5279, \"19\" : 7816, \"09\" : 6797, \"20\" : 7684, \"10\" : 7314, \"21\" : 7906 }, \"2015-02-22\" : { \"00\" : 5115, \"11\" : 11702, \"22\" : 14301, \"01\" : 1852, \"12\" : 11944, \"23\" : 10325, \"02\" : 263, \"13\" : 12475, \"03\" : 226, \"14\" : 12998, \"04\" : 202, \"15\" : 13538, \"05\" : 1211, \"16\" : 13479, \"06\" : 3413, \"17\" : 13908, \"07\" : 5615, \"18\" : 14569, \"08\" : 7793, \"19\" : 15324, \"09\" : 9728, \"20\" : 15437, \"10\" : 11034, \"21\" : 15922 }, \"2015-01-11\" : { \"00\" : 2990, \"11\" : 7345, \"22\" : 8651, \"01\" : 1142, \"12\" : 7693, \"23\" : 6141, \"02\" : 122, \"13\" : 7934, \"03\" : 148, \"14\" : 8042, \"04\" : 129, \"15\" : 8312, \"05\" : 863, \"16\" : 8715, \"06\" : 2144, \"17\" : 8781, \"07\" : 3547, \"18\" : 9178, \"08\" : 4901, \"19\" : 9215, \"09\" : 6177, \"20\" : 9552, \"10\" : 7043, \"21\" : 9649 }, \"2015-02-23\" : { \"00\" : 6155, \"11\" : 13724, \"22\" : 11188, \"01\" : 2249, \"12\" : 13559, \"23\" : 8173, \"02\" : 204, \"13\" : 13735, \"03\" : 207, \"14\" : 13460, \"04\" : 237, \"15\" : 13388, \"05\" : 1625, \"16\" : 13240, \"06\" : 4334, \"17\" : 13064, \"07\" : 7174, \"18\" : 13070, \"08\" : 9799, \"19\" : 13129, \"09\" : 12297, \"20\" : 12835, \"10\" : 13602, \"21\" : 12972 }, \"2015-01-18\" : { \"00\" : 2278, \"11\" : 5770, \"22\" : 6365, \"01\" : 867, \"12\" : 5964, \"23\" : 4560, \"02\" : 103, \"13\" : 6076, \"03\" : 93, \"14\" : 6210, \"04\" : 115, \"15\" : 6355, \"05\" : 674, \"16\" : 6568, \"06\" : 1740, \"17\" : 6646, \"07\" : 2878, \"18\" : 6876, \"08\" : 4044, \"19\" : 6944, \"09\" : 5097, \"20\" : 7208, \"10\" : 5820, \"21\" : 7113 }, \"2015-01-19\" : { \"00\" : 2807, \"11\" : 5261, \"22\" : 4202, \"01\" : 953, \"12\" : 5185, \"23\" : 3036, \"02\" : 93, \"13\" : 5111, \"03\" : 108, \"14\" : 5229, \"04\" : 80, \"15\" : 5190, \"05\" : 651, \"16\" : 5016, \"06\" : 1664, \"17\" : 4974, \"07\" : 2730, \"18\" : 4963, \"08\" : 3859, \"19\" : 4909, \"09\" : 4808, \"20\" : 4773, \"10\" : 5350, \"21\" : 4778 }, \"2015-02-20\" : { \"00\" : 5125, \"11\" : 13893, \"22\" : 11894, \"01\" : 1903, \"12\" : 13912, \"23\" : 8716, \"02\" : 220, \"13\" : 13832, \"03\" : 240, \"14\" : 14001, \"04\" : 260, \"15\" : 14003, \"05\" : 1637, \"16\" : 13783, \"06\" : 4393, \"17\" : 13983, \"07\" : 7242, \"18\" : 13949, \"08\" : 9997, \"19\" : 13689, \"09\" : 12689, \"20\" : 13853, \"10\" : 14073, \"21\" : 13622 }, \"2015-02-21\" : { \"00\" : 5305, \"11\" : 13945, \"22\" : 11360, \"01\" : 1927, \"12\" : 13979, \"23\" : 8205, \"02\" : 252, \"13\" : 13893, \"03\" : 262, \"14\" : 13604, \"04\" : 217, \"15\" : 13481, \"05\" : 1592, \"16\" : 13414, \"06\" : 4420, \"17\" : 13494, \"07\" : 6908, \"18\" : 13013, \"08\" : 9931, \"19\" : 13221, \"09\" : 12729, \"20\" : 13208, \"10\" : 13932, \"21\" : 12968 }, \"2015-01-05\" : { \"00\" : 2676, \"11\" : 6714, \"22\" : 4558, \"01\" : 952, \"12\" : 6586, \"23\" : 3431, \"02\" : 107, \"13\" : 6350, \"03\" : 82, \"14\" : 6301, \"04\" : 72, \"15\" : 6188, \"05\" : 725, \"16\" : 6179, \"06\" : 2114, \"17\" : 6132, \"07\" : 3576, \"18\" : 5779, \"08\" : 4852, \"19\" : 5760, \"09\" : 6232, \"20\" : 5577, \"10\" : 6855, \"21\" : 5505 }, \"2015-02-17\" : { \"00\" : 4764, \"11\" : 14267, \"22\" : 10563, \"01\" : 1864, \"12\" : 13938, \"23\" : 7760, \"02\" : 225, \"13\" : 13744, \"03\" : 212, \"14\" : 13528, \"04\" : 221, \"15\" : 13502, \"05\" : 1616, \"16\" : 13221, \"06\" : 4573, \"17\" : 12772, \"07\" : 7327, \"18\" : 12750, \"08\" : 10397, \"19\" : 12435, \"09\" : 13162, \"20\" : 12468, \"10\" : 14562, \"21\" : 12181 }, \"2015-01-06\" : { \"00\" : 2101, \"11\" : 7718, \"22\" : 4818, \"01\" : 793, \"12\" : 7504, \"23\" : 3447, \"02\" : 102, \"13\" : 7441, \"03\" : 91, \"14\" : 7000, \"04\" : 126, \"15\" : 6804, \"05\" : 899, \"16\" : 6766, \"06\" : 2578, \"17\" : 6331, \"07\" : 3975, \"18\" : 6216, \"08\" : 5714, \"19\" : 5918, \"09\" : 7240, \"20\" : 5761, \"10\" : 7766, \"21\" : 5621 }, \"2015-02-18\" : { \"00\" : 4615, \"11\" : 14199, \"22\" : 10007, \"01\" : 1721, \"12\" : 14185, \"23\" : 7480, \"02\" : 232, \"13\" : 13727, \"03\" : 218, \"14\" : 13451, \"04\" : 187, \"15\" : 13483, \"05\" : 1707, \"16\" : 13105, \"06\" : 4628, \"17\" : 12856, \"07\" : 7469, \"18\" : 12651, \"08\" : 10319, \"19\" : 12259, \"09\" : 13164, \"20\" : 12049, \"10\" : 14673, \"21\" : 11618 }, \"2015-01-03\" : { \"00\" : 2778, \"11\" : 5583, \"22\" : 6231, \"01\" : 1033, \"12\" : 5865, \"23\" : 4423, \"02\" : 111, \"13\" : 5781, \"03\" : 109, \"14\" : 6095, \"04\" : 125, \"15\" : 6266, \"05\" : 619, \"16\" : 6355, \"06\" : 1729, \"17\" : 6501, \"07\" : 2724, \"18\" : 6611, \"08\" : 3984, \"19\" : 6675, \"09\" : 5007, \"20\" : 6977, \"10\" : 5619, \"21\" : 7006 }, \"2015-02-15\" : { \"00\" : 5095, \"11\" : 11372, \"22\" : 10720, \"01\" : 1815, \"12\" : 11519, \"23\" : 7608, \"02\" : 218, \"13\" : 11427, \"03\" : 201, \"14\" : 11622, \"04\" : 182, \"15\" : 11727, \"05\" : 1207, \"16\" : 11795, \"06\" : 3455, \"17\" : 11729, \"07\" : 5643, \"18\" : 11638, \"08\" : 7895, \"19\" : 12058, \"09\" : 10284, \"20\" : 12160, \"10\" : 11433, \"21\" : 12115 }, \"2015-01-04\" : { \"00\" : 2760, \"11\" : 6717, \"22\" : 6282, \"01\" : 936, \"12\" : 6860, \"23\" : 4575, \"02\" : 105, \"13\" : 6845, \"03\" : 117, \"14\" : 6781, \"04\" : 124, \"15\" : 7005, \"05\" : 770, \"16\" : 6895, \"06\" : 2033, \"17\" : 6858, \"07\" : 3313, \"18\" : 6968, \"08\" : 4708, \"19\" : 7003, \"09\" : 5996, \"20\" : 7105, \"10\" : 6724, \"21\" : 7159 }, \"2015-02-16\" : { \"00\" : 4615, \"11\" : 13799, \"22\" : 11131, \"01\" : 1742, \"12\" : 13331, \"23\" : 8128, \"02\" : 188, \"13\" : 13403, \"03\" : 187, \"14\" : 13296, \"04\" : 181, \"15\" : 13304, \"05\" : 1513, \"16\" : 12961, \"06\" : 4258, \"17\" : 13134, \"07\" : 6889, \"18\" : 13071, \"08\" : 9808, \"19\" : 12768, \"09\" : 12355, \"20\" : 12902, \"10\" : 13659, \"21\" : 12668 }, \"2015-01-01\" : { \"22\" : 5914, \"12\" : 6107, \"23\" : 4258, \"13\" : 6260, \"14\" : 6332, \"15\" : 6361, \"16\" : 6490, \"17\" : 6545, \"18\" : 6460, \"19\" : 6438, \"20\" : 6771, \"21\" : 6642 }, \"2015-02-13\" : { \"00\" : 4365, \"11\" : 9904, \"22\" : 7920, \"01\" : 1586, \"12\" : 9965, \"23\" : 5788, \"02\" : 187, \"13\" : 9833, \"03\" : 150, \"14\" : 9582, \"04\" : 182, \"15\" : 9674, \"05\" : 1176, \"16\" : 9527, \"06\" : 3271, \"17\" : 9590, \"07\" : 5181, \"18\" : 9576, \"08\" : 7140, \"19\" : 9256, \"09\" : 9061, \"20\" : 9135, \"10\" : 9972, \"21\" : 9207 }, \"2015-01-02\" : { \"00\" : 2514, \"11\" : 5620, \"22\" : 6259, \"01\" : 950, \"12\" : 5749, \"23\" : 4455, \"02\" : 81, \"13\" : 5977, \"03\" : 97, \"14\" : 6115, \"04\" : 80, \"15\" : 6227, \"05\" : 579, \"16\" : 6431, \"06\" : 1665, \"17\" : 6487, \"07\" : 2751, \"18\" : 6755, \"08\" : 3853, \"19\" : 6681, \"09\" : 4712, \"20\" : 6928, \"10\" : 5530, \"21\" : 7138 }, \"2015-02-14\" : { \"00\" : 3540, \"11\" : 12700, \"22\" : 11463, \"01\" : 1335, \"12\" : 12849, \"23\" : 8179, \"02\" : 166, \"13\" : 12794, \"03\" : 174, \"14\" : 12948, \"04\" : 171, \"15\" : 13028, \"05\" : 1500, \"16\" : 12970, \"06\" : 4001, \"17\" : 13056, \"07\" : 6388, \"18\" : 12997, \"08\" : 8785, \"19\" : 12873, \"09\" : 11534, \"20\" : 12919, \"10\" : 12658, \"21\" : 12975 }, \"2015-02-11\" : { \"00\" : 3782, \"11\" : 9384, \"22\" : 8645, \"01\" : 1398, \"12\" : 9435, \"23\" : 6324, \"02\" : 200, \"13\" : 9502, \"03\" : 192, \"14\" : 9526, \"04\" : 166, \"15\" : 9498, \"05\" : 1097, \"16\" : 9648, \"06\" : 2849, \"17\" : 9735, \"07\" : 4868, \"18\" : 9841, \"08\" : 6400, \"19\" : 9717, \"09\" : 8286, \"20\" : 9860, \"10\" : 9352, \"21\" : 9999 }, \"2015-02-12\" : { \"00\" : 3761, \"11\" : 11212, \"22\" : 10238, \"01\" : 1408, \"12\" : 10992, \"23\" : 7154, \"02\" : 172, \"13\" : 11115, \"03\" : 191, \"14\" : 11151, \"04\" : 167, \"15\" : 11294, \"05\" : 1257, \"16\" : 11216, \"06\" : 3481, \"17\" : 11197, \"07\" : 5558, \"18\" : 11348, \"08\" : 7734, \"19\" : 11300, \"09\" : 9716, \"20\" : 11313, \"10\" : 11019, \"21\" : 11546 }, \"2015-01-09\" : { \"00\" : 2682, \"11\" : 7845, \"22\" : 6183, \"01\" : 974, \"12\" : 7634, \"23\" : 4364, \"02\" : 114, \"13\" : 7525, \"03\" : 147, \"14\" : 7518, \"04\" : 122, \"15\" : 7499, \"05\" : 885, \"16\" : 7480, \"06\" : 2441, \"17\" : 7201, \"07\" : 3956, \"18\" : 7216, \"08\" : 5542, \"19\" : 7171, \"09\" : 7006, \"20\" : 6998, \"10\" : 7803, \"21\" : 6972 }, \"2015-01-07\" : { \"00\" : 2150, \"11\" : 7153, \"22\" : 5681, \"01\" : 708, \"12\" : 6981, \"23\" : 4132, \"02\" : 116, \"13\" : 7048, \"03\" : 94, \"14\" : 6952, \"04\" : 81, \"15\" : 6828, \"05\" : 769, \"16\" : 6755, \"06\" : 2255, \"17\" : 6822, \"07\" : 3601, \"18\" : 6717, \"08\" : 5186, \"19\" : 6725, \"09\" : 6441, \"20\" : 6647, \"10\" : 7091, \"21\" : 6506 }, \"2015-02-19\" : { \"00\" : 4552, \"11\" : 12999, \"22\" : 11743, \"01\" : 1674, \"12\" : 13316, \"23\" : 8461, \"02\" : 195, \"13\" : 13209, \"03\" : 227, \"14\" : 13203, \"04\" : 246, \"15\" : 13243, \"05\" : 1496, \"16\" : 13018, \"06\" : 4194, \"17\" : 13218, \"07\" : 6783, \"18\" : 13087, \"08\" : 9105, \"19\" : 13221, \"09\" : 11744, \"20\" : 13269, \"10\" : 13204, \"21\" : 13123 }, \"2015-01-08\" : { \"00\" : 2496, \"11\" : 7615, \"22\" : 6093, \"01\" : 918, \"12\" : 7625, \"23\" : 4461, \"02\" : 132, \"13\" : 7560, \"03\" : 115, \"14\" : 7673, \"04\" : 111, \"15\" : 7524, \"05\" : 884, \"16\" : 7284, \"06\" : 2434, \"17\" : 7291, \"07\" : 3994, \"18\" : 7093, \"08\" : 5539, \"19\" : 7156, \"09\" : 7034, \"20\" : 7047, \"10\" : 7708, \"21\" : 6971 }, \"2015-02-10\" : { \"00\" : 4942, \"11\" : 11617, \"22\" : 8638, \"01\" : 1747, \"12\" : 11384, \"23\" : 6155, \"02\" : 188, \"13\" : 11259, \"03\" : 176, \"14\" : 11110, \"04\" : 133, \"15\" : 10906, \"05\" : 1347, \"16\" : 10931, \"06\" : 3666, \"17\" : 10537, \"07\" : 6107, \"18\" : 10412, \"08\" : 8486, \"19\" : 10272, \"09\" : 10920, \"20\" : 10033, \"10\" : 11891, \"21\" : 9878 }, \"2015-02-06\" : { \"00\" : 3373, \"11\" : 9183, \"22\" : 8955, \"01\" : 1297, \"12\" : 9452, \"23\" : 6331, \"02\" : 166, \"13\" : 9394, \"03\" : 153, \"14\" : 9467, \"04\" : 151, \"15\" : 9663, \"05\" : 1052, \"16\" : 9809, \"06\" : 2857, \"17\" : 9952, \"07\" : 4568, \"18\" : 9755, \"08\" : 6330, \"19\" : 9854, \"09\" : 8326, \"20\" : 9968, \"10\" : 9288, \"21\" : 10060 }, \"2015-02-07\" : { \"00\" : 3842, \"11\" : 8121, \"22\" : 9036, \"01\" : 1413, \"12\" : 8174, \"23\" : 6516, \"02\" : 165, \"13\" : 8535, \"03\" : 129, \"14\" : 8586, \"04\" : 148, \"15\" : 9173, \"05\" : 922, \"16\" : 9097, \"06\" : 2406, \"17\" : 9357, \"07\" : 3876, \"18\" : 9605, \"08\" : 5412, \"19\" : 9801, \"09\" : 7106, \"20\" : 9862, \"10\" : 7902, \"21\" : 10088 }, \"2015-02-04\" : { \"00\" : 3058, \"11\" : 8418, \"22\" : 8057, \"01\" : 1083, \"12\" : 8526, \"23\" : 5663, \"02\" : 157, \"13\" : 8658, \"03\" : 172, \"14\" : 8677, \"04\" : 157, \"15\" : 8838, \"05\" : 1011, \"16\" : 8857, \"06\" : 2606, \"17\" : 8742, \"07\" : 4346, \"18\" : 8808, \"08\" : 5911, \"19\" : 8772, \"09\" : 7653, \"20\" : 9036, \"10\" : 8523, \"21\" : 9216 }, \"2015-02-05\" : { \"00\" : 3486, \"11\" : 9411, \"22\" : 7546, \"01\" : 1288, \"12\" : 9122, \"23\" : 5432, \"02\" : 171, \"13\" : 8988, \"03\" : 151, \"14\" : 9193, \"04\" : 155, \"15\" : 9170, \"05\" : 1081, \"16\" : 8887, \"06\" : 2971, \"17\" : 9101, \"07\" : 4685, \"18\" : 8913, \"08\" : 6596, \"19\" : 8843, \"09\" : 8518, \"20\" : 8699, \"10\" : 9424, \"21\" : 8606 }, \"2015-02-02\" : { \"00\" : 2591, \"11\" : 7838, \"22\" : 6279, \"01\" : 940, \"12\" : 7760, \"23\" : 4588, \"02\" : 125, \"13\" : 7532, \"03\" : 147, \"14\" : 7490, \"04\" : 159, \"15\" : 7737, \"05\" : 940, \"16\" : 7391, \"06\" : 2599, \"17\" : 7450, \"07\" : 4049, \"18\" : 7379, \"08\" : 5607, \"19\" : 7347, \"09\" : 7077, \"20\" : 7254, \"10\" : 7893, \"21\" : 7284 }, \"2015-02-03\" : { \"00\" : 2780, \"11\" : 6761, \"22\" : 6643, \"01\" : 1013, \"12\" : 6661, \"23\" : 4956, \"02\" : 136, \"13\" : 6882, \"03\" : 127, \"14\" : 6957, \"04\" : 141, \"15\" : 7150, \"05\" : 761, \"16\" : 7168, \"06\" : 2063, \"17\" : 7244, \"07\" : 3451, \"18\" : 7327, \"08\" : 4690, \"19\" : 7354, \"09\" : 5885, \"20\" : 7554, \"10\" : 6745, \"21\" : 7613 }, \"2015-02-01\" : { \"00\" : 3651, \"11\" : 6621, \"22\" : 5716, \"01\" : 1360, \"12\" : 6563, \"23\" : 4034, \"02\" : 139, \"13\" : 6725, \"03\" : 128, \"14\" : 6487, \"04\" : 143, \"15\" : 6608, \"05\" : 791, \"16\" : 6580, \"06\" : 2170, \"17\" : 6590, \"07\" : 3366, \"18\" : 6503, \"08\" : 4570, \"19\" : 6613, \"09\" : 5900, \"20\" : 6503, \"10\" : 6596, \"21\" : 6670 }, \"2015-02-08\" : { \"00\" : 3952, \"11\" : 9957, \"22\" : 9885, \"01\" : 1378, \"12\" : 9974, \"23\" : 7158, \"02\" : 182, \"13\" : 10218, \"03\" : 199, \"14\" : 10334, \"04\" : 186, \"15\" : 10234, \"05\" : 1153, \"16\" : 10492, \"06\" : 3116, \"17\" : 10681, \"07\" : 4929, \"18\" : 10867, \"08\" : 6866, \"19\" : 11007, \"09\" : 8764, \"20\" : 11209, \"10\" : 9464, \"21\" : 11209 }, \"2015-02-09\" : { \"00\" : 4265, \"11\" : 12022, \"22\" : 11244, \"01\" : 1590, \"12\" : 12245, \"23\" : 7951, \"02\" : 222, \"13\" : 12156, \"03\" : 179, \"14\" : 12203, \"04\" : 199, \"15\" : 12253, \"05\" : 1349, \"16\" : 12409, \"06\" : 3663, \"17\" : 12488, \"07\" : 6118, \"18\" : 12391, \"08\" : 8249, \"19\" : 12426, \"09\" : 10602, \"20\" : 12506, \"10\" : 12191, \"21\" : 12577 } }".replace(" ", "")).toMap();

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("impression_log");

            Parser.parseCSV(impressionsFile);
            Map<String, Map<String, Integer>> resNumImpressions = DBQuery.getNumImpressions();

            assertEquals("Correct Num Impressions in file", expectedJsonMap, resNumImpressions);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testClickDayNum() {
        final Map<String, Object> expectedJsonMap = new JSONObject("{ \"2015-01-30\" : { \"00\" : 5, \"11\" : 17, \"22\" : 17, \"01\" : 5, \"12\" : 16, \"23\" : 5, \"13\" : 19, \"14\" : 9, \"15\" : 12, \"05\" : 1, \"16\" : 8, \"06\" : 10, \"17\" : 9, \"07\" : 11, \"18\" : 13, \"08\" : 12, \"19\" : 14, \"09\" : 14, \"20\" : 20, \"10\" : 20, \"21\" : 16 }, \"2015-01-31\" : { \"00\" : 6, \"11\" : 19, \"22\" : 14, \"12\" : 15, \"23\" : 18, \"13\" : 21, \"14\" : 22, \"15\" : 22, \"05\" : 4, \"16\" : 23, \"06\" : 4, \"17\" : 26, \"07\" : 14, \"18\" : 18, \"08\" : 12, \"19\" : 20, \"09\" : 20, \"20\" : 19, \"10\" : 17, \"21\" : 21 }, \"2015-01-27\" : { \"00\" : 8, \"11\" : 15, \"22\" : 12, \"01\" : 1, \"12\" : 22, \"23\" : 6, \"13\" : 24, \"14\" : 17, \"15\" : 10, \"16\" : 13, \"06\" : 7, \"17\" : 15, \"07\" : 13, \"18\" : 18, \"08\" : 15, \"19\" : 13, \"09\" : 15, \"20\" : 18, \"10\" : 17, \"21\" : 11 }, \"2015-01-28\" : { \"00\" : 5, \"11\" : 13, \"22\" : 12, \"01\" : 4, \"12\" : 13, \"23\" : 21, \"13\" : 16, \"14\" : 18, \"04\" : 1, \"15\" : 9, \"05\" : 1, \"16\" : 10, \"06\" : 6, \"17\" : 10, \"07\" : 12, \"18\" : 16, \"08\" : 8, \"19\" : 16, \"09\" : 12, \"20\" : 16, \"10\" : 13, \"21\" : 8 }, \"2015-01-25\" : { \"00\" : 7, \"11\" : 10, \"22\" : 12, \"01\" : 1, \"12\" : 12, \"23\" : 9, \"13\" : 16, \"14\" : 16, \"15\" : 20, \"05\" : 4, \"16\" : 13, \"06\" : 6, \"17\" : 16, \"07\" : 4, \"18\" : 10, \"08\" : 7, \"19\" : 18, \"09\" : 9, \"20\" : 13, \"10\" : 17, \"21\" : 14 }, \"2015-01-26\" : { \"00\" : 5, \"11\" : 18, \"22\" : 7, \"01\" : 3, \"12\" : 25, \"23\" : 11, \"13\" : 22, \"14\" : 13, \"04\" : 2, \"15\" : 22, \"05\" : 3, \"16\" : 17, \"06\" : 5, \"17\" : 6, \"07\" : 12, \"18\" : 20, \"08\" : 10, \"19\" : 12, \"09\" : 21, \"20\" : 20, \"10\" : 15, \"21\" : 8 }, \"2015-01-23\" : { \"00\" : 4, \"11\" : 13, \"22\" : 10, \"01\" : 3, \"12\" : 20, \"23\" : 10, \"02\" : 1, \"13\" : 13, \"14\" : 15, \"15\" : 22, \"05\" : 3, \"16\" : 18, \"06\" : 2, \"17\" : 13, \"07\" : 15, \"18\" : 8, \"08\" : 14, \"19\" : 17, \"09\" : 14, \"20\" : 10, \"10\" : 21, \"21\" : 13 }, \"2015-01-24\" : { \"00\" : 4, \"11\" : 8, \"22\" : 14, \"12\" : 13, \"23\" : 7, \"13\" : 15, \"03\" : 1, \"14\" : 13, \"15\" : 11, \"05\" : 1, \"16\" : 18, \"06\" : 6, \"17\" : 11, \"07\" : 9, \"18\" : 14, \"08\" : 9, \"19\" : 10, \"09\" : 11, \"20\" : 11, \"10\" : 16, \"21\" : 15 }, \"2015-01-21\" : { \"00\" : 8, \"11\" : 11, \"22\" : 20, \"01\" : 5, \"12\" : 15, \"23\" : 5, \"13\" : 19, \"14\" : 19, \"15\" : 19, \"05\" : 1, \"16\" : 19, \"06\" : 5, \"17\" : 10, \"07\" : 13, \"18\" : 15, \"08\" : 17, \"19\" : 13, \"09\" : 20, \"20\" : 21, \"10\" : 12, \"21\" : 15 }, \"2015-01-22\" : { \"00\" : 7, \"11\" : 10, \"22\" : 12, \"01\" : 3, \"12\" : 16, \"23\" : 12, \"13\" : 21, \"14\" : 17, \"15\" : 18, \"05\" : 1, \"16\" : 14, \"06\" : 8, \"17\" : 16, \"07\" : 9, \"18\" : 20, \"08\" : 9, \"19\" : 17, \"09\" : 21, \"20\" : 18, \"10\" : 17, \"21\" : 14 }, \"2015-01-29\" : { \"00\" : 8, \"11\" : 11, \"22\" : 12, \"01\" : 4, \"12\" : 15, \"23\" : 15, \"02\" : 1, \"13\" : 11, \"14\" : 15, \"04\" : 1, \"15\" : 14, \"05\" : 4, \"16\" : 14, \"06\" : 6, \"17\" : 10, \"07\" : 4, \"18\" : 15, \"08\" : 10, \"19\" : 16, \"09\" : 9, \"20\" : 13, \"10\" : 17, \"21\" : 10 }, \"2015-01-20\" : { \"00\" : 5, \"11\" : 12, \"22\" : 6, \"01\" : 3, \"12\" : 10, \"23\" : 7, \"13\" : 7, \"14\" : 14, \"15\" : 10, \"05\" : 2, \"16\" : 13, \"17\" : 15, \"07\" : 6, \"18\" : 6, \"08\" : 5, \"19\" : 16, \"09\" : 10, \"20\" : 15, \"10\" : 12, \"21\" : 11 }, \"2015-01-16\" : { \"00\" : 7, \"11\" : 10, \"22\" : 13, \"12\" : 8, \"23\" : 3, \"13\" : 6, \"14\" : 17, \"15\" : 17, \"16\" : 12, \"06\" : 10, \"17\" : 12, \"07\" : 5, \"18\" : 18, \"08\" : 6, \"19\" : 10, \"09\" : 18, \"20\" : 7, \"10\" : 11, \"21\" : 12 }, \"2015-02-28\" : { \"00\" : 5, \"11\" : 31, \"12\" : 1, \"02\" : 1, \"05\" : 1, \"06\" : 7, \"07\" : 14, \"08\" : 18, \"09\" : 23, \"10\" : 23 }, \"2015-01-17\" : { \"00\" : 3, \"11\" : 13, \"22\" : 11, \"01\" : 2, \"12\" : 9, \"23\" : 6, \"13\" : 12, \"14\" : 13, \"15\" : 7, \"16\" : 10, \"06\" : 5, \"17\" : 12, \"07\" : 5, \"18\" : 16, \"08\" : 7, \"19\" : 12, \"09\" : 9, \"20\" : 11, \"10\" : 9, \"21\" : 12 }, \"2015-01-14\" : { \"00\" : 10, \"11\" : 18, \"22\" : 13, \"01\" : 1, \"12\" : 13, \"23\" : 8, \"13\" : 26, \"14\" : 6, \"04\" : 1, \"15\" : 14, \"05\" : 3, \"16\" : 11, \"06\" : 5, \"17\" : 13, \"07\" : 7, \"18\" : 17, \"08\" : 11, \"19\" : 18, \"09\" : 16, \"20\" : 18, \"10\" : 20, \"21\" : 16 }, \"2015-02-26\" : { \"00\" : 16, \"11\" : 34, \"22\" : 19, \"01\" : 6, \"12\" : 30, \"23\" : 16, \"13\" : 33, \"03\" : 1, \"14\" : 19, \"15\" : 40, \"05\" : 2, \"16\" : 26, \"06\" : 10, \"17\" : 22, \"07\" : 14, \"18\" : 24, \"08\" : 25, \"19\" : 23, \"09\" : 24, \"20\" : 23, \"10\" : 33, \"21\" : 20 }, \"2015-01-15\" : { \"00\" : 10, \"11\" : 15, \"22\" : 13, \"12\" : 13, \"23\" : 7, \"13\" : 18, \"14\" : 10, \"04\" : 2, \"15\" : 21, \"16\" : 17, \"06\" : 3, \"17\" : 17, \"07\" : 6, \"18\" : 11, \"08\" : 6, \"19\" : 14, \"09\" : 15, \"20\" : 11, \"10\" : 17, \"21\" : 17 }, \"2015-02-27\" : { \"00\" : 11, \"11\" : 23, \"22\" : 31, \"01\" : 4, \"12\" : 20, \"23\" : 20, \"13\" : 27, \"03\" : 1, \"14\" : 29, \"15\" : 22, \"05\" : 3, \"16\" : 28, \"06\" : 7, \"17\" : 34, \"07\" : 17, \"18\" : 29, \"08\" : 19, \"19\" : 38, \"09\" : 20, \"20\" : 30, \"10\" : 32, \"21\" : 33 }, \"2015-01-12\" : { \"00\" : 9, \"11\" : 3, \"22\" : 13, \"12\" : 13, \"23\" : 12, \"13\" : 12, \"14\" : 23, \"15\" : 12, \"16\" : 18, \"06\" : 2, \"17\" : 13, \"07\" : 8, \"18\" : 11, \"08\" : 11, \"19\" : 11, \"09\" : 11, \"20\" : 9, \"10\" : 13, \"21\" : 17 }, \"2015-02-24\" : { \"00\" : 7, \"11\" : 32, \"22\" : 19, \"01\" : 5, \"12\" : 38, \"23\" : 18, \"13\" : 30, \"14\" : 38, \"04\" : 1, \"15\" : 33, \"05\" : 6, \"16\" : 24, \"06\" : 8, \"17\" : 32, \"07\" : 19, \"18\" : 31, \"08\" : 13, \"19\" : 28, \"09\" : 24, \"20\" : 29, \"10\" : 33, \"21\" : 20 }, \"2015-01-13\" : { \"00\" : 10, \"11\" : 12, \"22\" : 8, \"12\" : 17, \"23\" : 5, \"13\" : 13, \"14\" : 14, \"15\" : 16, \"05\" : 2, \"16\" : 13, \"06\" : 3, \"17\" : 15, \"07\" : 7, \"18\" : 12, \"08\" : 16, \"19\" : 18, \"09\" : 9, \"20\" : 15, \"10\" : 25, \"21\" : 12 }, \"2015-02-25\" : { \"00\" : 10, \"11\" : 35, \"22\" : 32, \"12\" : 29, \"23\" : 16, \"13\" : 32, \"14\" : 30, \"15\" : 34, \"05\" : 6, \"16\" : 36, \"06\" : 5, \"17\" : 25, \"07\" : 17, \"18\" : 29, \"08\" : 18, \"19\" : 24, \"09\" : 35, \"20\" : 35, \"10\" : 29, \"21\" : 35 }, \"2015-01-10\" : { \"00\" : 6, \"11\" : 16, \"22\" : 15, \"01\" : 3, \"12\" : 14, \"23\" : 9, \"13\" : 14, \"14\" : 9, \"04\" : 1, \"15\" : 16, \"05\" : 3, \"16\" : 18, \"06\" : 6, \"17\" : 15, \"07\" : 2, \"18\" : 15, \"08\" : 15, \"19\" : 20, \"09\" : 9, \"20\" : 9, \"10\" : 21, \"21\" : 17 }, \"2015-02-22\" : { \"00\" : 14, \"11\" : 22, \"22\" : 26, \"01\" : 6, \"12\" : 30, \"23\" : 20, \"02\" : 2, \"13\" : 29, \"03\" : 3, \"14\" : 16, \"15\" : 30, \"05\" : 1, \"16\" : 22, \"06\" : 7, \"17\" : 34, \"07\" : 10, \"18\" : 33, \"08\" : 23, \"19\" : 33, \"09\" : 23, \"20\" : 25, \"10\" : 23, \"21\" : 28 }, \"2015-01-11\" : { \"00\" : 10, \"11\" : 18, \"22\" : 20, \"01\" : 3, \"12\" : 19, \"23\" : 16, \"02\" : 2, \"13\" : 18, \"14\" : 18, \"15\" : 22, \"05\" : 1, \"16\" : 20, \"06\" : 4, \"17\" : 18, \"07\" : 5, \"18\" : 21, \"08\" : 12, \"19\" : 20, \"09\" : 15, \"20\" : 16, \"10\" : 18, \"21\" : 16 }, \"2015-02-23\" : { \"00\" : 13, \"11\" : 27, \"22\" : 18, \"01\" : 7, \"12\" : 32, \"23\" : 9, \"13\" : 31, \"14\" : 17, \"15\" : 32, \"05\" : 1, \"16\" : 33, \"06\" : 8, \"17\" : 31, \"07\" : 16, \"18\" : 23, \"08\" : 21, \"19\" : 20, \"09\" : 20, \"20\" : 22, \"10\" : 24, \"21\" : 37 }, \"2015-01-18\" : { \"00\" : 4, \"11\" : 12, \"22\" : 13, \"01\" : 5, \"12\" : 16, \"23\" : 8, \"13\" : 13, \"14\" : 6, \"15\" : 16, \"05\" : 2, \"16\" : 16, \"06\" : 3, \"17\" : 20, \"07\" : 4, \"18\" : 11, \"08\" : 12, \"19\" : 9, \"09\" : 12, \"20\" : 20, \"10\" : 7, \"21\" : 10 }, \"2015-01-19\" : { \"00\" : 4, \"11\" : 18, \"22\" : 10, \"12\" : 8, \"23\" : 4, \"13\" : 16, \"14\" : 14, \"15\" : 10, \"05\" : 1, \"16\" : 16, \"06\" : 4, \"17\" : 9, \"07\" : 4, \"18\" : 9, \"08\" : 9, \"19\" : 8, \"09\" : 8, \"20\" : 7, \"10\" : 12, \"21\" : 7 }, \"2015-02-20\" : { \"00\" : 8, \"11\" : 21, \"22\" : 23, \"01\" : 8, \"12\" : 17, \"23\" : 20, \"13\" : 35, \"03\" : 2, \"14\" : 28, \"15\" : 36, \"05\" : 1, \"16\" : 31, \"06\" : 12, \"17\" : 20, \"07\" : 7, \"18\" : 32, \"08\" : 13, \"19\" : 27, \"09\" : 32, \"20\" : 20, \"10\" : 32, \"21\" : 20 }, \"2015-02-21\" : { \"00\" : 13, \"11\" : 25, \"22\" : 20, \"01\" : 4, \"12\" : 33, \"23\" : 13, \"13\" : 27, \"03\" : 1, \"14\" : 26, \"15\" : 25, \"05\" : 3, \"16\" : 29, \"06\" : 6, \"17\" : 28, \"07\" : 14, \"18\" : 31, \"08\" : 12, \"19\" : 32, \"09\" : 25, \"20\" : 27, \"10\" : 27, \"21\" : 27 }, \"2015-01-05\" : { \"00\" : 5, \"11\" : 13, \"22\" : 13, \"01\" : 5, \"12\" : 15, \"23\" : 7, \"13\" : 12, \"14\" : 9, \"15\" : 10, \"05\" : 1, \"16\" : 9, \"06\" : 2, \"17\" : 15, \"07\" : 6, \"18\" : 11, \"08\" : 10, \"19\" : 14, \"09\" : 9, \"20\" : 12, \"10\" : 20, \"21\" : 12 }, \"2015-02-17\" : { \"00\" : 6, \"11\" : 26, \"22\" : 20, \"01\" : 5, \"12\" : 25, \"23\" : 8, \"13\" : 36, \"14\" : 32, \"15\" : 24, \"05\" : 1, \"16\" : 29, \"06\" : 11, \"17\" : 26, \"07\" : 11, \"18\" : 25, \"08\" : 22, \"19\" : 17, \"09\" : 29, \"20\" : 29, \"10\" : 28, \"21\" : 18 }, \"2015-01-06\" : { \"00\" : 4, \"11\" : 19, \"22\" : 9, \"01\" : 1, \"12\" : 16, \"23\" : 8, \"13\" : 12, \"14\" : 9, \"04\" : 2, \"15\" : 11, \"05\" : 3, \"16\" : 17, \"06\" : 6, \"17\" : 13, \"07\" : 8, \"18\" : 9, \"08\" : 7, \"19\" : 13, \"09\" : 14, \"20\" : 18, \"10\" : 16, \"21\" : 7 }, \"2015-02-18\" : { \"00\" : 5, \"11\" : 23, \"22\" : 22, \"01\" : 1, \"12\" : 27, \"23\" : 12, \"13\" : 21, \"14\" : 29, \"15\" : 36, \"05\" : 2, \"16\" : 20, \"06\" : 11, \"17\" : 30, \"07\" : 16, \"18\" : 19, \"08\" : 21, \"19\" : 21, \"09\" : 25, \"20\" : 23, \"10\" : 25, \"21\" : 19 }, \"2015-01-03\" : { \"00\" : 2, \"11\" : 9, \"22\" : 11, \"01\" : 3, \"12\" : 11, \"23\" : 10, \"13\" : 20, \"14\" : 10, \"15\" : 7, \"16\" : 15, \"06\" : 4, \"17\" : 12, \"07\" : 11, \"18\" : 11, \"08\" : 8, \"19\" : 16, \"09\" : 5, \"20\" : 16, \"10\" : 9, \"21\" : 12 }, \"2015-02-15\" : { \"00\" : 17, \"11\" : 21, \"22\" : 21, \"01\" : 2, \"12\" : 31, \"23\" : 20, \"13\" : 29, \"14\" : 23, \"04\" : 1, \"15\" : 22, \"16\" : 18, \"06\" : 9, \"17\" : 29, \"07\" : 10, \"18\" : 22, \"08\" : 11, \"19\" : 20, \"09\" : 21, \"20\" : 19, \"10\" : 23, \"21\" : 24 }, \"2015-01-04\" : { \"00\" : 2, \"11\" : 13, \"22\" : 13, \"01\" : 1, \"12\" : 17, \"23\" : 9, \"02\" : 1, \"13\" : 11, \"03\" : 1, \"14\" : 16, \"15\" : 23, \"05\" : 5, \"16\" : 16, \"06\" : 7, \"17\" : 18, \"07\" : 6, \"18\" : 13, \"08\" : 9, \"19\" : 17, \"09\" : 13, \"20\" : 10, \"10\" : 14, \"21\" : 11 }, \"2015-02-16\" : { \"00\" : 11, \"11\" : 27, \"22\" : 21, \"01\" : 3, \"12\" : 26, \"23\" : 14, \"02\" : 1, \"13\" : 28, \"14\" : 17, \"15\" : 21, \"05\" : 3, \"16\" : 24, \"06\" : 12, \"17\" : 36, \"07\" : 17, \"18\" : 30, \"08\" : 22, \"19\" : 31, \"09\" : 20, \"20\" : 38, \"10\" : 18, \"21\" : 23 }, \"2015-01-01\" : { \"22\" : 16, \"12\" : 6, \"23\" : 7, \"13\" : 12, \"14\" : 13, \"15\" : 11, \"16\" : 15, \"17\" : 7, \"18\" : 13, \"19\" : 17, \"20\" : 11, \"21\" : 17 }, \"2015-02-13\" : { \"00\" : 5, \"11\" : 12, \"22\" : 25, \"01\" : 4, \"12\" : 17, \"23\" : 7, \"02\" : 1, \"13\" : 20, \"03\" : 1, \"14\" : 23, \"15\" : 22, \"16\" : 16, \"06\" : 8, \"17\" : 19, \"07\" : 12, \"18\" : 21, \"08\" : 15, \"19\" : 21, \"09\" : 15, \"20\" : 22, \"10\" : 14, \"21\" : 17 }, \"2015-01-02\" : { \"00\" : 7, \"11\" : 10, \"22\" : 13, \"01\" : 3, \"12\" : 8, \"23\" : 11, \"13\" : 14, \"14\" : 17, \"15\" : 17, \"05\" : 3, \"16\" : 3, \"06\" : 4, \"17\" : 7, \"07\" : 3, \"18\" : 13, \"08\" : 5, \"19\" : 11, \"09\" : 11, \"20\" : 16, \"10\" : 13, \"21\" : 16 }, \"2015-02-14\" : { \"00\" : 7, \"11\" : 26, \"22\" : 25, \"01\" : 3, \"12\" : 36, \"23\" : 7, \"13\" : 25, \"14\" : 29, \"15\" : 21, \"05\" : 6, \"16\" : 19, \"06\" : 5, \"17\" : 27, \"07\" : 13, \"18\" : 25, \"08\" : 13, \"19\" : 29, \"09\" : 23, \"20\" : 22, \"10\" : 27, \"21\" : 38 }, \"2015-02-11\" : { \"00\" : 7, \"11\" : 20, \"22\" : 16, \"01\" : 2, \"12\" : 19, \"23\" : 19, \"13\" : 19, \"14\" : 15, \"04\" : 1, \"15\" : 13, \"05\" : 1, \"16\" : 17, \"06\" : 3, \"17\" : 17, \"07\" : 8, \"18\" : 17, \"08\" : 18, \"19\" : 24, \"09\" : 15, \"20\" : 20, \"10\" : 17, \"21\" : 24 }, \"2015-02-12\" : { \"00\" : 8, \"11\" : 30, \"22\" : 23, \"01\" : 3, \"12\" : 15, \"23\" : 7, \"13\" : 22, \"14\" : 19, \"04\" : 1, \"15\" : 18, \"05\" : 1, \"16\" : 17, \"06\" : 7, \"17\" : 19, \"07\" : 11, \"18\" : 23, \"08\" : 16, \"19\" : 17, \"09\" : 13, \"20\" : 29, \"10\" : 25, \"21\" : 22 }, \"2015-01-09\" : { \"00\" : 7, \"11\" : 17, \"22\" : 18, \"01\" : 2, \"12\" : 12, \"23\" : 10, \"02\" : 1, \"13\" : 16, \"14\" : 14, \"15\" : 17, \"05\" : 3, \"16\" : 21, \"06\" : 5, \"17\" : 12, \"07\" : 11, \"18\" : 10, \"08\" : 7, \"19\" : 13, \"09\" : 14, \"20\" : 16, \"10\" : 16, \"21\" : 14 }, \"2015-01-07\" : { \"00\" : 3, \"11\" : 18, \"22\" : 8, \"12\" : 11, \"23\" : 12, \"13\" : 18, \"14\" : 13, \"15\" : 14, \"16\" : 16, \"06\" : 4, \"17\" : 11, \"07\" : 7, \"18\" : 20, \"08\" : 8, \"19\" : 10, \"09\" : 18, \"20\" : 11, \"10\" : 16, \"21\" : 13 }, \"2015-02-19\" : { \"00\" : 9, \"11\" : 27, \"22\" : 25, \"01\" : 4, \"12\" : 37, \"23\" : 19, \"02\" : 1, \"13\" : 26, \"14\" : 33, \"04\" : 1, \"15\" : 25, \"05\" : 1, \"16\" : 20, \"06\" : 6, \"17\" : 30, \"07\" : 9, \"18\" : 19, \"08\" : 15, \"19\" : 27, \"09\" : 20, \"20\" : 26, \"10\" : 34, \"21\" : 33 }, \"2015-01-08\" : { \"00\" : 5, \"11\" : 18, \"22\" : 14, \"01\" : 3, \"12\" : 8, \"23\" : 9, \"13\" : 19, \"14\" : 15, \"15\" : 19, \"05\" : 4, \"16\" : 13, \"06\" : 2, \"17\" : 16, \"07\" : 14, \"18\" : 19, \"08\" : 9, \"19\" : 9, \"09\" : 18, \"20\" : 13, \"10\" : 21, \"21\" : 20 }, \"2015-02-10\" : { \"00\" : 10, \"11\" : 16, \"22\" : 17, \"01\" : 1, \"12\" : 24, \"23\" : 11, \"02\" : 1, \"13\" : 23, \"14\" : 18, \"15\" : 27, \"05\" : 1, \"16\" : 29, \"06\" : 7, \"17\" : 17, \"07\" : 12, \"18\" : 22, \"08\" : 17, \"19\" : 24, \"09\" : 20, \"20\" : 22, \"10\" : 31, \"21\" : 13 }, \"2015-02-06\" : { \"00\" : 10, \"11\" : 13, \"22\" : 21, \"01\" : 6, \"12\" : 11, \"23\" : 16, \"13\" : 15, \"03\" : 1, \"14\" : 28, \"15\" : 23, \"05\" : 2, \"16\" : 21, \"06\" : 7, \"17\" : 25, \"07\" : 7, \"18\" : 24, \"08\" : 14, \"19\" : 17, \"09\" : 20, \"20\" : 18, \"10\" : 19, \"21\" : 18 }, \"2015-02-07\" : { \"00\" : 3, \"11\" : 14, \"22\" : 21, \"01\" : 2, \"12\" : 8, \"23\" : 11, \"02\" : 1, \"13\" : 22, \"03\" : 1, \"14\" : 15, \"15\" : 20, \"16\" : 24, \"06\" : 1, \"17\" : 15, \"07\" : 10, \"18\" : 19, \"08\" : 17, \"19\" : 12, \"09\" : 15, \"20\" : 27, \"10\" : 11, \"21\" : 16 }, \"2015-02-04\" : { \"00\" : 4, \"11\" : 25, \"22\" : 20, \"01\" : 3, \"12\" : 18, \"23\" : 8, \"13\" : 23, \"14\" : 23, \"15\" : 23, \"05\" : 1, \"16\" : 16, \"06\" : 4, \"17\" : 16, \"07\" : 12, \"18\" : 10, \"08\" : 24, \"19\" : 13, \"09\" : 12, \"20\" : 19, \"10\" : 19, \"21\" : 20 }, \"2015-02-05\" : { \"00\" : 6, \"11\" : 18, \"22\" : 16, \"01\" : 5, \"12\" : 22, \"23\" : 8, \"13\" : 24, \"14\" : 15, \"04\" : 1, \"15\" : 16, \"05\" : 2, \"16\" : 20, \"06\" : 6, \"17\" : 30, \"07\" : 8, \"18\" : 13, \"08\" : 14, \"19\" : 15, \"09\" : 24, \"20\" : 17, \"10\" : 18, \"21\" : 27 }, \"2015-02-02\" : { \"00\" : 8, \"11\" : 14, \"22\" : 7, \"01\" : 1, \"12\" : 12, \"23\" : 16, \"02\" : 1, \"13\" : 12, \"14\" : 14, \"15\" : 13, \"16\" : 12, \"06\" : 5, \"17\" : 15, \"07\" : 8, \"18\" : 10, \"08\" : 3, \"19\" : 16, \"09\" : 19, \"20\" : 13, \"10\" : 19, \"21\" : 12 }, \"2015-02-03\" : { \"00\" : 6, \"11\" : 12, \"22\" : 13, \"01\" : 3, \"12\" : 11, \"23\" : 6, \"13\" : 13, \"14\" : 19, \"15\" : 9, \"16\" : 12, \"06\" : 5, \"17\" : 16, \"07\" : 5, \"18\" : 16, \"08\" : 5, \"19\" : 17, \"09\" : 5, \"20\" : 24, \"10\" : 11, \"21\" : 17 }, \"2015-02-01\" : { \"00\" : 10, \"11\" : 10, \"22\" : 6, \"01\" : 1, \"12\" : 12, \"23\" : 8, \"02\" : 1, \"13\" : 11, \"14\" : 9, \"15\" : 15, \"16\" : 15, \"06\" : 4, \"17\" : 13, \"07\" : 7, \"18\" : 9, \"08\" : 9, \"19\" : 11, \"09\" : 15, \"20\" : 15, \"10\" : 12, \"21\" : 16 }, \"2015-02-08\" : { \"00\" : 11, \"11\" : 18, \"22\" : 17, \"01\" : 3, \"12\" : 28, \"23\" : 12, \"02\" : 1, \"13\" : 22, \"14\" : 26, \"15\" : 26, \"05\" : 3, \"16\" : 21, \"06\" : 6, \"17\" : 22, \"07\" : 11, \"18\" : 14, \"08\" : 11, \"19\" : 20, \"09\" : 16, \"20\" : 20, \"10\" : 18, \"21\" : 21 }, \"2015-02-09\" : { \"00\" : 4, \"11\" : 24, \"22\" : 16, \"01\" : 1, \"12\" : 19, \"23\" : 14, \"02\" : 2, \"13\" : 28, \"03\" : 3, \"14\" : 25, \"04\" : 1, \"15\" : 24, \"05\" : 2, \"16\" : 33, \"06\" : 6, \"17\" : 19, \"07\" : 10, \"18\" : 20, \"08\" : 11, \"19\" : 22, \"09\" : 19, \"20\" : 28, \"10\" : 21, \"21\" : 21 } }").toMap();

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");

            Parser.parseCSV(clickFile);
            Map<String, Map<String, Integer>> resNumClicks = DBQuery.getNumClicks();

            assertEquals("Correct Num Clicks file:", expectedJsonMap, resNumClicks);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testServerConversions() {
        final Map<String, Object> expectedJsonMap = new JSONObject("{ \"2015-01-30\" : { \"00\" : 1, \"11\" : 1, \"13\" : 1, \"14\" : 2, \"16\" : 1, \"07\" : 2, \"18\" : 1, \"08\" : 2, \"19\" : 3, \"20\" : 1, \"10\" : 1 }, \"2015-01-31\" : { \"00\" : 1, \"22\" : 1, \"14\" : 1, \"16\" : 2, \"06\" : 1, \"17\" : 1, \"08\" : 1, \"19\" : 1, \"20\" : 1, \"21\" : 1 }, \"2015-01-27\" : { \"00\" : 1, \"11\" : 1, \"14\" : 1, \"16\" : 1, \"07\" : 1, \"18\" : 1, \"09\" : 2 }, \"2015-01-28\" : { \"23\" : 2, \"14\" : 1, \"17\" : 2, \"18\" : 1, \"19\" : 2, \"20\" : 1, \"21\" : 2 }, \"2015-01-25\" : { \"22\" : 1, \"12\" : 1, \"14\" : 1, \"15\" : 1, \"06\" : 1, \"18\" : 1, \"19\" : 4, \"20\" : 1, \"10\" : 1 }, \"2015-01-26\" : { \"11\" : 1, \"22\" : 2, \"01\" : 1, \"13\" : 2, \"14\" : 1, \"16\" : 1, \"07\" : 1, \"18\" : 1, \"19\" : 1 }, \"2015-01-23\" : { \"13\" : 1, \"14\" : 1, \"15\" : 1, \"18\" : 2, \"08\" : 1, \"21\" : 1 }, \"2015-01-24\" : { \"00\" : 1, \"22\" : 1, \"14\" : 1, \"07\" : 1, \"18\" : 1, \"19\" : 1, \"21\" : 2 }, \"2015-01-21\" : { \"22\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 1, \"14\" : 2, \"15\" : 1, \"16\" : 1, \"08\" : 1, \"09\" : 1, \"21\" : 1 }, \"2015-01-22\" : { \"22\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 2, \"15\" : 2, \"16\" : 1, \"06\" : 1, \"07\" : 1, \"18\" : 2 }, \"2015-01-29\" : { \"12\" : 1, \"23\" : 1, \"15\" : 1, \"16\" : 2, \"19\" : 1, \"20\" : 1, \"10\" : 1 }, \"2015-01-20\" : { \"14\" : 3, \"07\" : 1, \"19\" : 1, \"09\" : 1, \"10\" : 1 }, \"2015-01-16\" : { \"12\" : 1, \"13\" : 1, \"15\" : 1, \"07\" : 1, \"18\" : 2, \"09\" : 1, \"20\" : 1, \"21\" : 1 }, \"2015-02-28\" : { \"00\" : 1, \"11\" : 2, \"07\" : 1, \"09\" : 2, \"10\" : 1 }, \"2015-01-17\" : { \"14\" : 2, \"18\" : 2, \"10\" : 1 }, \"2015-01-14\" : { \"00\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 1, \"10\" : 1, \"21\" : 2 }, \"2015-02-26\" : { \"22\" : 1, \"12\" : 2, \"23\" : 1, \"15\" : 1, \"17\" : 1, \"07\" : 1, \"18\" : 1, \"08\" : 2, \"09\" : 4, \"10\" : 1, \"21\" : 1 }, \"2015-01-15\" : { \"11\" : 1, \"22\" : 1, \"13\" : 2, \"14\" : 1, \"15\" : 1, \"06\" : 1, \"21\" : 3 }, \"2015-02-27\" : { \"11\" : 1, \"22\" : 1, \"12\" : 2, \"23\" : 2, \"14\" : 2, \"16\" : 2, \"17\" : 2, \"07\" : 1, \"08\" : 1, \"20\" : 1, \"10\" : 1, \"21\" : 1 }, \"2015-01-12\" : { \"00\" : 2, \"13\" : 1, \"14\" : 2, \"16\" : 1, \"17\" : 3, \"19\" : 1, \"20\" : 1, \"10\" : 1, \"21\" : 1 }, \"2015-02-24\" : { \"11\" : 1, \"12\" : 1, \"23\" : 2, \"13\" : 3, \"14\" : 1, \"15\" : 1, \"17\" : 2, \"07\" : 1, \"18\" : 3, \"19\" : 2, \"09\" : 2, \"20\" : 1, \"10\" : 1, \"21\" : 1 }, \"2015-01-13\" : { \"00\" : 1, \"11\" : 1, \"12\" : 1, \"15\" : 2, \"07\" : 1, \"10\" : 3 }, \"2015-02-25\" : { \"00\" : 1, \"11\" : 2, \"22\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 1, \"15\" : 1, \"16\" : 3, \"07\" : 1, \"08\" : 1, \"19\" : 1, \"20\" : 3 }, \"2015-01-10\" : { \"00\" : 1, \"13\" : 1, \"14\" : 2, \"15\" : 1, \"17\" : 1, \"10\" : 2 }, \"2015-02-22\" : { \"00\" : 1, \"11\" : 1, \"22\" : 1, \"23\" : 1, \"13\" : 1, \"17\" : 2, \"08\" : 1, \"19\" : 1, \"21\" : 1 }, \"2015-01-11\" : { \"00\" : 1, \"22\" : 1, \"23\" : 2, \"13\" : 3, \"16\" : 2, \"17\" : 1, \"07\" : 1, \"18\" : 1, \"08\" : 1, \"09\" : 1, \"20\" : 2, \"21\" : 1 }, \"2015-02-23\" : { \"11\" : 1, \"23\" : 1, \"16\" : 3, \"17\" : 1, \"19\" : 2, \"10\" : 1, \"21\" : 1 }, \"2015-01-18\" : { \"22\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 1, \"15\" : 2, \"16\" : 2, \"18\" : 1, \"20\" : 1 }, \"2015-01-19\" : { \"22\" : 1, \"05\" : 1, \"16\" : 1, \"06\" : 1, \"18\" : 1, \"09\" : 2, \"20\" : 1, \"10\" : 1 }, \"2015-02-20\" : { \"00\" : 2, \"11\" : 2, \"22\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 1, \"15\" : 1, \"16\" : 6, \"17\" : 1, \"08\" : 2, \"19\" : 2, \"10\" : 1 }, \"2015-02-21\" : { \"12\" : 3, \"14\" : 2, \"15\" : 3, \"16\" : 1, \"17\" : 1, \"07\" : 2, \"19\" : 2, \"20\" : 1, \"21\" : 2 }, \"2015-01-05\" : { \"11\" : 2, \"23\" : 1, \"13\" : 1, \"15\" : 1, \"17\" : 1, \"08\" : 3, \"19\" : 2, \"09\" : 1, \"20\" : 1 }, \"2015-02-17\" : { \"00\" : 1, \"12\" : 1, \"15\" : 1, \"07\" : 1, \"18\" : 4, \"19\" : 2, \"09\" : 1, \"20\" : 1, \"21\" : 1 }, \"2015-01-06\" : { \"11\" : 1, \"22\" : 2, \"23\" : 1, \"14\" : 1, \"05\" : 1, \"16\" : 1, \"06\" : 1, \"19\" : 1, \"20\" : 3 }, \"2015-02-18\" : { \"22\" : 1, \"12\" : 2, \"23\" : 2, \"13\" : 1, \"14\" : 1, \"15\" : 3, \"06\" : 1, \"17\" : 1, \"07\" : 1, \"18\" : 1, \"08\" : 2, \"09\" : 1, \"20\" : 1 }, \"2015-01-03\" : { \"22\" : 1, \"12\" : 2, \"13\" : 1, \"14\" : 2, \"17\" : 1, \"18\" : 1, \"08\" : 1, \"19\" : 1, \"20\" : 3, \"21\" : 1 }, \"2015-02-15\" : { \"22\" : 2, \"12\" : 3, \"23\" : 1, \"13\" : 2, \"15\" : 2, \"07\" : 1, \"21\" : 1 }, \"2015-01-04\" : { \"11\" : 1, \"22\" : 1, \"13\" : 1, \"17\" : 2, \"19\" : 2, \"21\" : 1 }, \"2015-02-16\" : { \"11\" : 1, \"13\" : 1, \"16\" : 2, \"17\" : 1, \"18\" : 1, \"08\" : 1, \"19\" : 2, \"21\" : 1 }, \"2015-01-01\" : { \"22\" : 2, \"15\" : 1, \"18\" : 1 }, \"2015-02-13\" : { \"00\" : 1, \"11\" : 1, \"22\" : 2, \"12\" : 1, \"13\" : 2, \"14\" : 1, \"17\" : 2, \"07\" : 1, \"18\" : 1, \"08\" : 1, \"20\" : 2, \"21\" : 1 }, \"2015-01-02\" : { \"23\" : 1, \"07\" : 1, \"18\" : 2, \"20\" : 1, \"21\" : 1 }, \"2015-02-14\" : { \"12\" : 3, \"13\" : 2, \"14\" : 3, \"16\" : 1, \"07\" : 1, \"08\" : 1, \"20\" : 1, \"21\" : 4 }, \"2015-02-11\" : { \"22\" : 1, \"12\" : 1, \"16\" : 1, \"18\" : 1, \"08\" : 1, \"19\" : 1, \"09\" : 2, \"21\" : 3 }, \"2015-02-12\" : { \"13\" : 1, \"14\" : 3, \"15\" : 1, \"06\" : 1, \"18\" : 1, \"19\" : 1, \"10\" : 1, \"21\" : 2 }, \"2015-01-09\" : { \"00\" : 1, \"22\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 1, \"16\" : 3, \"07\" : 2, \"08\" : 1, \"21\" : 1 }, \"2015-01-07\" : { \"13\" : 2, \"18\" : 1, \"08\" : 2, \"19\" : 1, \"09\" : 2, \"10\" : 3, \"21\" : 1 }, \"2015-02-19\" : { \"22\" : 1, \"12\" : 1, \"23\" : 1, \"13\" : 2, \"18\" : 2, \"19\" : 4, \"09\" : 1, \"20\" : 1, \"10\" : 2 }, \"2015-01-08\" : { \"13\" : 1, \"07\" : 1, \"18\" : 1, \"09\" : 1, \"20\" : 1, \"10\" : 1, \"21\" : 2 }, \"2015-02-10\" : { \"11\" : 1, \"23\" : 1, \"13\" : 1, \"14\" : 1, \"16\" : 2, \"07\" : 1, \"18\" : 2, \"19\" : 1, \"09\" : 2, \"20\" : 1, \"10\" : 4 }, \"2015-02-06\" : { \"11\" : 1, \"22\" : 1, \"23\" : 1, \"17\" : 3, \"08\" : 1, \"20\" : 1, \"10\" : 1, \"21\" : 1 }, \"2015-02-07\" : { \"22\" : 3, \"23\" : 2, \"13\" : 1, \"17\" : 1, \"07\" : 1, \"18\" : 1, \"08\" : 1, \"19\" : 1, \"21\" : 2 }, \"2015-02-04\" : { \"13\" : 1, \"14\" : 1, \"15\" : 1, \"17\" : 1, \"07\" : 3, \"18\" : 1, \"09\" : 1, \"20\" : 1, \"10\" : 1, \"21\" : 3 }, \"2015-02-05\" : { \"11\" : 2, \"22\" : 1, \"15\" : 1, \"18\" : 1, \"21\" : 1 }, \"2015-02-02\" : { \"11\" : 1, \"14\" : 1, \"17\" : 2, \"20\" : 1, \"21\" : 2 }, \"2015-02-03\" : { \"00\" : 1, \"11\" : 1, \"12\" : 1, \"18\" : 1, \"20\" : 1, \"10\" : 2 }, \"2015-02-01\" : { \"02\" : 1, \"15\" : 1, \"17\" : 3, \"07\" : 1, \"18\" : 1, \"08\" : 1, \"21\" : 1 }, \"2015-02-08\" : { \"00\" : 2, \"11\" : 1, \"12\" : 2, \"23\" : 1, \"14\" : 2, \"17\" : 1, \"18\" : 2, \"19\" : 3, \"09\" : 1, \"20\" : 1, \"10\" : 1 }, \"2015-02-09\" : { \"11\" : 2, \"22\" : 2, \"12\" : 1, \"23\" : 1, \"15\" : 1, \"16\" : 2, \"07\" : 1, \"18\" : 1, \"19\" : 1, \"09\" : 3, \"21\" : 2 } }".replace(" ", "")).toMap();

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("server_log");

            Parser.parseCSV(serverFile);
            Map<String, Map<String, Integer>> resNumConversions = DBQuery.getNumConversions();

            assertEquals("Correct num of Conversions", expectedJsonMap, resNumConversions);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testCTR() {
        final Double expectedResult = 0.002011044547004117;

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");
            handler.dropCollection("impression_log");

            Parser.parseCSV(clickFile);
            Parser.parseCSV(impressionsFile);

            Double result = DBQuery.getTotalCTR();

            assertEquals("Correct Num Clicks file:", expectedResult, result);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }
    
    @Test
    public void testTotalNumClicks() {
    	final Double expectedResult = 17754d;

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");

            Parser.parseCSV(clickFile);

            Double result = DBQuery.getTotalNumClicks();

            assertEquals("Correct Num Clicks file:", expectedResult, result);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }
    
    @Test
    public void testTotalImpressions() {
    	final Double expectedResult = 8828248d;

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("impression_log");

            Parser.parseCSV(impressionsFile);

            Double result = DBQuery.getTotalNumImpressions();

            assertEquals("Correct Num Clicks file:", expectedResult, result);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }
    
    @Test
    public void testTotalCostImpressions() {
    	final Float expectedResult = 10242.122f;

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");

            Parser.parseCSV(clickFile);

            Float result = new Float(DBQuery.getTotalCostImpressions());

            assertEquals("Correct Num Clicks file:", expectedResult, result);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }
    
    @Test
    public void testTotalCostClick() {
    	final Double expectedResult = 103303.5723070003;

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");

            Parser.parseCSV(clickFile);

            Double result = DBQuery.getTotalCostClicks();

            assertEquals("Correct Num Clicks file:", expectedResult, result);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }
    
    @Test
    public void testTotalCostCampaign() {
    	final Double expectedResult = 113545.69400700268;

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");

            Parser.parseCSV(clickFile);

            Double result = DBQuery.getTotalCostCampaign();

            assertEquals("Correct Num Clicks file:", expectedResult, result);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }
    
    @Test
    public void testClickParse() {

        DBHandler handler = null;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");

            JSONObject parse = Parser.parseCSV(clickFile);
            String parseAnalytics = parse.toString();
            String resAnalytics = handler.retrieveAllDocuments("click_log").toString();

            assertEquals("Correct JSON file", resAnalytics, parseAnalytics);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testImpressionsParse() {

        DBHandler handler = null;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("impression_log");

            JSONObject parse = Parser.parseCSV(impressionsFile);
            String parseAnalytics = parse.toString();
            String resAnalytics = handler.retrieveAllDocuments("impression_log").toString();

            assertEquals("Correct JSON file", resAnalytics, parseAnalytics);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }

    }

    @Test
    public void testCTROverTime() {
        final Map<String, Object> expectedCtrMap = new JSONObject("{2015-01-30={00=0.0016926201760324984, 11=0.0023716517857142855, 22=0.002631171645256152, 01=0.00432152117545376, 12=0.002158079309414621, 23=0.001126887536623845, 02=0.0, 13=0.0025818725370294875, 03=0.0, 14=0.0012134286099501146, 04=0.0, 15=0.0016155088852988692, 05=0.001182033096926714, 16=0.0011008669327095088, 06=0.004310344827586207, 17=0.0012264922322158627, 07=0.0029356818788364024, 18=0.0017653449212384573, 08=0.0022342208154905977, 19=0.001910480349344978, 09=0.002068252326783868, 20=0.0027605244996549345, 10=0.0027408524050979853, 21=0.002236198462613557}, 2015-01-31={00=0.0021321961620469083, 11=0.0019295216817304763, 22=0.0017029558447877388, 01=0.0, 12=0.001546232347180703, 23=0.0030513646380742497, 02=0.0, 13=0.0021694214876033058, 03=0.0, 14=0.0022826312512969496, 04=0.0, 15=0.002290950744558992, 05=0.003561887800534283, 16=0.0023689360387269542, 06=0.0012414649286157666, 17=0.0026707755521314844, 07=0.002679938744257274, 18=0.0018923465096719932, 08=0.001713796058269066, 19=0.0021247211303516414, 09=0.002257846014901784, 20=0.0019983172065628943, 10=0.0017362884281482995, 21=0.002216592780240659}, 2015-01-27={00=0.0028188865398167725, 11=0.0017383242554177773, 22=0.0019509022923101934, 01=9.84251968503937E-4, 12=0.0026537997587454767, 23=0.0013698630136986301, 02=0.0, 13=0.00293470286133529, 03=0.0, 14=0.0021173246979698593, 04=0.0, 15=0.0012551776076314798, 05=0.0, 16=0.001648700063411541, 06=0.0025371511417180137, 17=0.0019825535289452814, 07=0.0030303030303030303, 18=0.0023860021208907743, 08=0.0024346696964778446, 19=0.001752021563342318, 09=0.0018780518342306248, 20=0.0024556616643929058, 10=0.0019486474094452086, 21=0.0015761570425562401}, 2015-01-28={00=0.0018635855385762206, 11=0.0019157088122605363, 22=0.0017155110793423873, 01=0.0041841004184100415, 12=0.0018884369552585707, 23=0.004250151791135397, 02=0.0, 13=0.0022059837308699847, 03=0.0, 14=0.0025384289945000705, 04=0.009009009009009009, 15=0.0012515644555694619, 05=0.0013089005235602095, 16=0.001363884342607747, 06=0.0028846153846153848, 17=0.0013360053440213762, 07=0.003527336860670194, 18=0.002136752136752137, 08=0.0017115960633290544, 19=0.0020784619381657575, 09=0.002028054757478452, 20=0.002099737532808399, 10=0.001928211213289825, 21=0.0010209290454313426}, 2015-01-25={00=0.0030094582975064487, 11=0.001671681711802073, 22=0.0016032064128256513, 01=0.0011185682326621924, 12=0.0019111323459149545, 23=0.0017071320182094083, 02=0.0, 13=0.002528844634107792, 03=0.0, 14=0.0024476059354443937, 04=0.0, 15=0.002889338341519792, 05=0.0061823802163833074, 16=0.0018186905428091774, 06=0.003510825043885313, 17=0.0021780560849441874, 07=0.001438331535418914, 18=0.001321353065539112, 08=0.0017275419545903258, 19=0.002324680356450988, 09=0.0017139592458579318, 20=0.0016051364365971107, 10=0.0029421945309795776, 21=0.0017188459177409454}, 2015-01-26={00=0.0015969338869370809, 11=0.0022235948116121063, 22=0.0011214354373598205, 01=0.002512562814070352, 12=0.003182686187141948, 23=0.0023892267593397048, 02=0.0, 13=0.002777076495834385, 03=0.0, 14=0.0016533129848658272, 04=0.015503875968992248, 15=0.0028061224489795917, 05=0.0032822757111597373, 16=0.0022190314580341993, 06=0.0019470404984423676, 17=7.950178879024779E-4, 07=0.0028770079117717575, 18=0.0027344818156959257, 08=0.001736111111111111, 19=0.0015955325089748703, 09=0.002811997857525442, 20=0.0027386005751061206, 10=0.0018319491939423546, 21=0.0011025358324145535}, 2015-01-23={00=0.00145985401459854, 11=0.001546882436934793, 22=0.0018135654697134566, 01=0.0029615004935834156, 12=0.0024956326428749688, 23=0.0024838549428713363, 02=0.007518796992481203, 13=0.001696906409084976, 03=0.0, 14=0.0019656663608963437, 04=0.0, 15=0.0029443254817987153, 05=0.00322234156820623, 16=0.0023984010659560294, 06=7.567158531971245E-4, 17=0.0018629979936944684, 07=0.003395970115462984, 18=0.0011433471487780477, 08=0.002306805074971165, 19=0.002499632406998971, 09=0.0018286311389759666, 20=0.0015151515151515152, 10=0.0024390243902439024, 21=0.0020344287949921754}, 2015-01-24={00=0.0016460905349794238, 11=0.0011527377521613833, 22=0.0026954177897574125, 01=0.0, 12=0.0019270678920841982, 23=0.0019042437431991295, 02=0.0, 13=0.0021626297577854673, 03=0.008620689655172414, 14=0.0019798964361864148, 04=0.0, 15=0.0016983171221244403, 05=0.0012376237623762376, 16=0.0027842227378190253, 06=0.002805049088359046, 17=0.0017865843755075525, 07=0.0024429967426710096, 18=0.002259157656930773, 08=0.0017881978939002583, 19=0.001607717041800643, 09=0.0017485296455253536, 20=0.0018568534773801485, 10=0.002243409983174425, 21=0.002563226247436774}, 2015-01-21={00=0.0031720856463124504, 11=0.0014117043121149898, 22=0.002577319587628866, 01=0.005055611729019211, 12=0.001874297138573035, 23=8.882572392965003E-4, 02=0.0, 13=0.0023947567431308295, 03=0.0, 14=0.002374703162104737, 04=0.0, 15=0.002367306254672315, 05=0.0011961722488038277, 16=0.002304426925409339, 06=0.002073828287017835, 17=0.0011994722322178242, 07=0.0033487892838742917, 18=0.0017622180451127819, 08=0.00319909672563041, 19=0.0014771048744460858, 09=0.002932121389825539, 20=0.002375834370403892, 10=0.0015787396395211155, 21=0.0017237416685819352}, 2015-01-22={00=0.0020600353148911123, 11=0.0011160714285714285, 22=0.0019623875715453804, 01=0.0025252525252525255, 12=0.001877713883347025, 23=0.002716161158895428, 02=0.0, 13=0.0025, 03=0.0, 14=0.002109442858915498, 04=0.0, 15=0.0022363026462914647, 05=0.001040582726326743, 16=0.001779811848461734, 06=0.0029038112522686023, 17=0.0020536516493389807, 07=0.001956521739130435, 18=0.002704530087897228, 08=0.0013829133374308542, 19=0.002298539751216874, 09=0.002586206896551724, 20=0.0024637284423761293, 10=0.0018990169794459338, 21=0.0019807583474816073}, 2015-01-29={00=0.0025550942190993293, 11=0.0015647226173541964, 22=0.0017030939540164632, 01=0.0036663611365719525, 12=0.0021598272138228943, 23=0.0029047250193648335, 02=0.008928571428571428, 13=0.0015252357182473654, 03=0.0, 14=0.00204862059546572, 04=0.008333333333333333, 15=0.0019050210913049395, 05=0.005025125628140704, 16=0.001946607341490545, 06=0.0028557829604950024, 17=0.0013498920086393088, 07=0.0011665208515602217, 18=0.0019729054320662895, 08=0.002103934357248054, 19=0.002065049044914817, 09=0.0014827018121911038, 20=0.0016389309127584468, 10=0.002498163115356356, 21=0.0012470382840753212}, 2015-01-20={00=0.0026136957658128594, 11=0.002335084646818447, 22=0.0010602579961123874, 01=0.00424929178470255, 12=0.0018716077110237693, 23=0.0016742406122937097, 02=0.0, 13=0.0012950971322849213, 03=0.0, 14=0.00253210345451257, 04=0.0, 15=0.0017516202487300753, 05=0.0032626427406199023, 16=0.0022699493626680634, 06=0.0, 17=0.002454590083456063, 07=0.0024154589371980675, 18=9.933774834437086E-4, 08=0.001405283867341203, 19=0.002660458929165281, 09=0.0022925263640531865, 20=0.0024224806201550387, 10=0.002334176230305388, 21=0.0016998918250656777}, 2015-01-16={00=0.002843216896831844, 11=0.0017073587160662455, 22=0.002127659574468085, 01=0.0, 12=0.0013520365049856345, 23=6.767426122264832E-4, 02=0.0, 13=9.956853634251576E-4, 03=0.0, 14=0.0027610849439662173, 04=0.0, 15=0.002693709396292188, 05=0.0, 16=0.0018478595626732369, 06=0.005608524957936063, 17=0.0018317814074187146, 07=0.00175377060680463, 18=0.0026962252846015576, 08=0.0015113350125944584, 19=0.0014558159848595137, 09=0.003436426116838488, 20=0.0010432190760059613, 10=0.0019133762393459732, 21=0.0017376194613379669}, 2015-02-28={00=7.883948281299275E-4, 11=0.002412451361867704, 01=0.0, 12=1.0, 02=0.0038022813688212928, 03=0.0, 04=0.0, 05=6.872852233676976E-4, 06=0.0017224409448818897, 07=0.0020964360587002098, 08=0.001998445653380704, 09=0.0019750966079862603, 10=0.0018056209766054326}, 2015-01-17={00=0.001143728555089592, 11=0.002362347810285299, 22=0.002066892145809846, 01=0.001968503937007874, 12=0.0016100178890876566, 23=0.0015719151165837044, 02=0.0, 13=0.0020964360587002098, 03=0.0, 14=0.0022390630382363073, 04=0.0, 15=0.0012395962457942271, 05=0.0, 16=0.001725327812284334, 06=0.0028328611898017, 17=0.0020797227036395147, 07=0.0017959770114942528, 18=0.002686817800167926, 08=0.0017663386323492304, 19=0.0020060180541624875, 09=0.0018266693728435153, 20=0.0018305874521551007, 10=0.0016134815346002152, 21=0.002001000500250125}, 2015-01-14={00=0.004411116012351125, 11=0.0026026604973973396, 22=0.0020363408521303257, 01=0.0012004801920768306, 12=0.0018715807659084366, 23=0.0016985138004246285, 02=0.0, 13=0.003599612349439291, 03=0.0, 14=8.684324793747286E-4, 04=0.00847457627118644, 15=0.001969057665260197, 05=0.0037974683544303796, 16=0.0015222806531967894, 06=0.002326663564448581, 17=0.0018320180383314543, 07=0.0020155485171321624, 18=0.0023670286828181564, 08=0.0023046302116069557, 19=0.002537355511700028, 09=0.0026101141924959217, 20=0.002458680508127305, 10=0.0028851702250432777, 21=0.002179539572265359}, 2015-02-26={00=0.00253324889170361, 11=0.0022837184309511017, 22=0.0018031697826705894, 01=0.002644336712208021, 12=0.0020889910173386254, 23=0.002097535395909806, 02=0.0, 13=0.002355460385438972, 03=0.004524886877828055, 14=0.0013750180923433203, 04=0.0, 15=0.002885794675708823, 05=0.0011904761904761906, 16=0.0019573891440186706, 06=0.0021547080370609784, 17=0.0017002859571837081, 07=0.0018264840182648401, 18=0.0018608978832286578, 08=0.002342798238215725, 19=0.0018118796281707894, 09=0.0017797552836484984, 20=0.0018942513589194532, 10=0.0022044088176352704, 21=0.0016388069485414618}, 2015-01-15={00=0.0036350418029807343, 11=0.0018468357547402117, 22=0.002335609054976644, 01=0.0, 12=0.0016286644951140066, 23=0.0017596782302664656, 02=0.0, 13=0.002277904328018223, 03=0.0, 14=0.0012914890869172154, 04=0.015267175572519083, 15=0.002746893394375409, 05=0.0, 16=0.0022736391600909458, 06=0.0011467889908256881, 17=0.0024226877583012683, 07=0.0014144271570014145, 18=0.001575028636884307, 08=0.0010107816711590297, 19=0.002008896541828096, 09=0.001976284584980237, 20=0.0016388557806912992, 10=0.0020556227327690447, 21=0.0025946275946275945}, 2015-02-27={00=0.0023314963967782957, 11=0.0018770913245735737, 22=0.002149344796505581, 01=0.002284408909194746, 12=0.00157035175879397, 23=0.0019421246844047388, 02=0.0, 13=0.002080604145796409, 03=0.004, 14=0.002140695356905588, 04=0.0, 15=0.001596632556789317, 05=0.0022123893805309734, 16=0.001962158374211633, 06=0.0019267822736030828, 17=0.0023372516670103803, 07=0.0028399599064483794, 18=0.0019131811584641772, 08=0.0023670113367385073, 19=0.002440120721762024, 09=0.0019036740909956216, 20=0.0018919089361165416, 10=0.0027068177973270176, 21=0.0020079099482811073}, 2015-01-12={00=0.002338269680436477, 11=4.3446777697320784E-4, 22=0.0023567802755620013, 01=0.0, 12=0.001840317100792752, 23=0.00293470286133529, 02=0.0, 13=0.001700921332388377, 03=0.0, 14=0.0033217793183131137, 04=0.0, 15=0.0017654847726938355, 05=0.0, 16=0.0026857654431512983, 06=8.900756564307966E-4, 17=0.001973284760170006, 07=0.002178649237472767, 18=0.001666414179669747, 08=0.0021463414634146343, 19=0.0016899677369795667, 09=0.0017120622568093384, 20=0.0013659128851115495, 10=0.0017791159162446968, 21=0.0026153846153846153}, 2015-02-24={00=0.0014056224899598394, 11=0.0021320541008728097, 22=0.0015599343185550081, 01=0.002730748225013654, 12=0.0026070252469813393, 23=0.0020809248554913293, 02=0.0, 13=0.0020373514431239388, 03=0.0, 14=0.002585385766770989, 04=0.004347826086956522, 15=0.002276804194839244, 05=0.0035087719298245615, 16=0.001671309192200557, 06=0.0016845651716150768, 17=0.0022140732027952676, 07=0.002468814968814969, 18=0.002181869369369369, 08=0.0012235294117647058, 19=0.001991040318566451, 09=0.0017591438833101224, 20=0.002071280622812656, 10=0.0021938571998404467, 21=0.001452854859799506}, 2015-01-13={00=0.003930817610062893, 11=0.0016497113005224085, 22=0.0015319800842589046, 01=0.0, 12=0.002350013823610727, 23=0.0013276686139139671, 02=0.0, 13=0.0018563472797372554, 03=0.0, 14=0.002036067481093659, 04=0.0, 15=0.002384856163362647, 05=0.002372479240806643, 16=0.0019911165568999847, 06=0.00129926375054136, 17=0.002268602540834846, 07=0.0018597236981934113, 18=0.0018444512757454657, 08=0.0029856316476954657, 19=0.0029402156158118264, 09=0.0013505402160864347, 20=0.002406545804588481, 10=0.0033382294031245826, 21=0.001990049751243781}, 2015-02-25={00=0.0019138755980861245, 11=0.002402526084568918, 22=0.002221450885109337, 01=0.0, 12=0.0019472235278318673, 23=0.0015661707126076742, 02=0.0, 13=0.0021099828563892918, 03=0.0, 14=0.001987939831687761, 04=0.0, 15=0.002220045706823376, 05=0.00357355568790947, 16=0.002301937464032227, 06=0.0011079104808331486, 17=0.001598261091931978, 07=0.002336769759450172, 18=0.0018373035985808413, 08=0.0018279679090078195, 19=0.0014979403320434402, 09=0.0026885850361038563, 20=0.0021468441391155, 10=0.0020211876219682185, 21=0.002165841584158416}, 2015-01-10={00=0.0021810250817884407, 11=0.00212342402123424, 22=0.002148381552563735, 01=0.002912621359223301, 12=0.0019026909486273443, 23=0.0018039687312086591, 02=0.0, 13=0.00185602545406337, 03=0.0, 14=0.0011835875854813256, 04=0.00819672131147541, 15=0.0021197668256491787, 05=0.003703703703703704, 16=0.002364066193853428, 06=0.00264783759929391, 17=0.001970831690973591, 07=5.212405525149857E-4, 18=0.0019412449851171217, 08=0.0028414472437961733, 19=0.00255885363357216, 09=0.0013241135795203766, 20=0.0011712649661634565, 10=0.002871205906480722, 21=0.0021502656210473058}, 2015-02-22={00=0.002737047898338221, 11=0.0018800205093146471, 22=0.001818054681490805, 01=0.0032397408207343412, 12=0.0025117213663764233, 23=0.001937046004842615, 02=0.0076045627376425855, 13=0.0023246492985971945, 03=0.01327433628318584, 14=0.0012309586090167718, 04=0.0, 15=0.002215984635839858, 05=8.257638315441783E-4, 16=0.0016321685584984049, 06=0.0020509815411661296, 17=0.002444636180615473, 07=0.0017809439002671415, 18=0.0022650833962523167, 08=0.002951366611061209, 19=0.002153484729835552, 09=0.0023643092105263158, 20=0.001619485651357129, 10=0.0020844661953960484, 21=0.001758573043587489}, 2015-01-11={00=0.0033444816053511705, 11=0.002450646698434309, 22=0.002311871459946827, 01=0.002626970227670753, 12=0.0024697777200051994, 23=0.0026054388536069046, 02=0.01639344262295082, 13=0.002268716914544996, 03=0.0, 14=0.002238249191743347, 04=0.0, 15=0.0026467757459095282, 05=0.0011587485515643105, 16=0.002294893861158921, 06=0.0018656716417910447, 17=0.0020498804236419544, 07=0.00140964195094446, 18=0.002288080191762911, 08=0.002448479902060804, 19=0.002170374389582203, 09=0.0024283632831471587, 20=0.0016750418760469012, 10=0.002555729092716172, 21=0.001658202922582651}, 2015-02-23={00=0.0021121039805036554, 11=0.001967356455843777, 22=0.0016088666428316052, 01=0.0031124944419742106, 12=0.002360056051331219, 23=0.0011011868346996207, 02=0.0, 13=0.0022570076447033125, 03=0.0, 14=0.001263001485884101, 04=0.0, 15=0.0023902001792650133, 05=6.153846153846154E-4, 16=0.0024924471299093654, 06=0.0018458698661744347, 17=0.002372933251684017, 07=0.002230275996654586, 18=0.0017597551644988523, 08=0.00214307582406368, 19=0.0015233452662045852, 09=0.001626412946247052, 20=0.0017140631086871834, 10=0.00176444640494045, 21=0.0028522972556275054}, 2015-01-18={00=0.001755926251097454, 11=0.0020797227036395147, 22=0.00204241948153967, 01=0.0057670126874279125, 12=0.0026827632461435278, 23=0.0017543859649122807, 02=0.0, 13=0.002139565503620803, 03=0.0, 14=9.66183574879227E-4, 04=0.0, 15=0.0025177025963808025, 05=0.002967359050445104, 16=0.00243605359317905, 06=0.0017241379310344827, 17=0.003009328919650918, 07=0.001389854065323141, 18=0.0015997673065735892, 08=0.002967359050445104, 19=0.0012960829493087558, 09=0.002354326074161271, 20=0.002774694783573807, 10=0.0012027491408934709, 21=0.0014058765640376776}, 2015-01-19={00=0.0014250089063056644, 11=0.0034214027751378064, 22=0.002379819133745835, 01=0.0, 12=0.0015429122468659595, 23=0.0013175230566534915, 02=0.0, 13=0.003130502837018196, 03=0.0, 14=0.002677376171352075, 04=0.0, 15=0.0019267822736030828, 05=0.0015360983102918587, 16=0.003189792663476874, 06=0.002403846153846154, 17=0.0018094089264173703, 07=0.0014652014652014652, 18=0.0018134193028410237, 08=0.00233221041720653, 19=0.0016296598085149725, 09=0.0016638935108153079, 20=0.001466582861931699, 10=0.0022429906542056075, 21=0.0014650481372959396}, 2015-02-20={00=0.0015609756097560976, 11=0.0015115525804361909, 22=0.001933748108289894, 01=0.004203888596952181, 12=0.0012219666474985625, 23=0.002294630564479119, 02=0.0, 13=0.0025303643724696357, 03=0.008333333333333333, 14=0.0019998571530604956, 04=0.0, 15=0.0025708776690709133, 05=6.108735491753207E-4, 16=0.0022491475005441486, 06=0.0027316184839517414, 17=0.0014303082314238717, 07=9.665838166252416E-4, 18=0.002294071259588501, 08=0.0013003901170351106, 19=0.0019723865877712033, 09=0.002521869335645047, 20=0.0014437305998700643, 10=0.00227385774177503, 21=0.0014682131845543973}, 2015-02-21={00=0.0024505183788878417, 11=0.0017927572606669057, 22=0.0017605633802816902, 01=0.0020757654385054488, 12=0.002360683882967308, 23=0.0015843997562461913, 02=0.0, 13=0.0019434247462751025, 03=0.003816793893129771, 14=0.0019112025874742722, 04=0.0, 15=0.001854461835175432, 05=0.0018844221105527637, 16=0.002161920381690771, 06=0.0013574660633484162, 17=0.002074996294649474, 07=0.002026635784597568, 18=0.0023822331514639205, 08=0.0012083375289497532, 19=0.0024203918009227743, 09=0.0019640191688270877, 20=0.0020442156268927923, 10=0.001937984496124031, 21=0.002082048118445404}, 2015-01-05={00=0.0018684603886397607, 11=0.0019362526064938934, 22=0.0028521281263712154, 01=0.005252100840336135, 12=0.0022775584573337384, 23=0.0020402215097639173, 02=0.0, 13=0.001889763779527559, 03=0.0, 14=0.001428344707189335, 04=0.0, 15=0.0016160310277957336, 05=0.001379310344827586, 16=0.0014565463667260074, 06=9.46073793755913E-4, 17=0.002446183953033268, 07=0.0016778523489932886, 18=0.0019034435023360444, 08=0.002061005770816158, 19=0.0024305555555555556, 09=0.0014441591784338896, 20=0.002151694459386767, 10=0.0029175784099197666, 21=0.0021798365122615805}, 2015-02-17={00=0.0012594458438287153, 11=0.0018223873273988925, 22=0.0018934014957871818, 01=0.002682403433476395, 12=0.0017936576266322285, 23=0.0010309278350515464, 02=0.0, 13=0.002619324796274738, 03=0.0, 14=0.002365464222353637, 04=0.0, 15=0.0017775144423048438, 05=6.188118811881188E-4, 16=0.002193480069586264, 06=0.0024054231357970696, 17=0.0020357031005324147, 07=0.0015012965743141805, 18=0.00196078431372549, 08=0.0021159949985572763, 19=0.0013671089666264576, 09=0.0022033125664792583, 20=0.00232595444337504, 10=0.0019228128004395001, 21=0.0014777111895575075}, 2015-01-06={00=0.0019038553069966682, 11=0.002461777662606893, 22=0.0018679950186799503, 01=0.0012610340479192938, 12=0.0021321961620469083, 23=0.0023208587177255585, 02=0.0, 13=0.0016126864668727322, 03=0.0, 14=0.0012857142857142856, 04=0.015873015873015872, 15=0.0016166960611405056, 05=0.0033370411568409346, 16=0.002512562814070352, 06=0.0023273855702094647, 17=0.002053388090349076, 07=0.002012578616352201, 18=0.0014478764478764478, 08=0.001225061253062653, 19=0.0021966880702940185, 09=0.0019337016574585636, 20=0.003124457559451484, 10=0.0020602626834921455, 21=0.0012453300124533001}, 2015-02-18={00=0.0010834236186348862, 11=0.0016198323825621522, 22=0.002198461077245928, 01=5.810575246949448E-4, 12=0.0019034191046880507, 23=0.0016042780748663102, 02=0.0, 13=0.0015298317185109638, 03=0.0, 14=0.002155973533566278, 04=0.0, 15=0.0026700289253133577, 05=0.0011716461628588166, 16=0.0015261350629530714, 06=0.0023768366464995676, 17=0.0023335407591785935, 07=0.0021421877091980183, 18=0.0015018575606671409, 08=0.002035080918693672, 19=0.0017130271637164532, 09=0.001899118808872683, 20=0.001908872105568927, 10=0.0017038097185306344, 21=0.001635393355138578}, 2015-01-03={00=7.199424046076314E-4, 11=0.0016120365394948952, 22=0.0017653667148130317, 01=0.002904162633107454, 12=0.0018755328218243818, 23=0.0022609088853719197, 02=0.0, 13=0.0034596090641757483, 03=0.0, 14=0.0016406890894175555, 04=0.0, 15=0.0011171401212894988, 05=0.0, 16=0.0023603461841070024, 06=0.002313475997686524, 17=0.0018458698661744347, 07=0.004038179148311307, 18=0.0016638935108153079, 08=0.002008032128514056, 19=0.002397003745318352, 09=9.986019572598363E-4, 20=0.0022932492475275907, 10=0.001601708489054992, 21=0.0017128175849272054}, 2015-02-15={00=0.0033366045142296367, 11=0.001846640872317974, 22=0.001958955223880597, 01=0.0011019283746556473, 12=0.0026912058338397432, 23=0.0026288117770767614, 02=0.0, 13=0.0025378489542312067, 03=0.0, 14=0.0019790053347100325, 04=0.005494505494505495, 15=0.0018760126204485376, 05=0.0, 16=0.001526070368800339, 06=0.0026049204052098407, 17=0.002472504049791116, 07=0.00177210703526493, 18=0.001890359168241966, 08=0.0013932868904369855, 19=0.001658649859014762, 09=0.002042007001166861, 20=0.0015625, 10=0.0020117204583224003, 21=0.001981015270326042}, 2015-01-04={00=7.246376811594203E-4, 11=0.0019353878219443203, 22=0.0020694046482012097, 01=0.0010683760683760685, 12=0.002478134110787172, 23=0.0019672131147540984, 02=0.009523809523809525, 13=0.0016070124178232286, 03=0.008547008547008548, 14=0.0023595339920365727, 04=0.0, 15=0.0032833690221270523, 05=0.006493506493506494, 16=0.002320522117476432, 06=0.003443187407771766, 17=0.0026246719160104987, 07=0.0018110473890733474, 18=0.0018656716417910447, 08=0.0019116397621070519, 19=0.0024275310581179494, 09=0.0021681120747164776, 20=0.0014074595355383533, 10=0.002082093991671624, 21=0.0015365274479675933}, 2015-02-16={00=0.0023835319609967496, 11=0.0019566635263424887, 22=0.0018866229449285778, 01=0.001722158438576349, 12=0.0019503413097292025, 23=0.0017224409448818897, 02=0.005319148936170213, 13=0.0020890845333134374, 03=0.0, 14=0.0012785800240673888, 04=0.0, 15=0.0015784726398075767, 05=0.0019828155981493722, 16=0.0018517089730730654, 06=0.0028182245185533112, 17=0.002740977615349475, 07=0.0024677021338365512, 18=0.0022951572182694515, 08=0.0022430668841761825, 19=0.0024279448621553883, 09=0.0016187778227438284, 20=0.0029452798015811503, 10=0.001317812431363936, 21=0.0018155983580675718}, 2015-01-01={22=0.002705444707473791, 12=9.824791223186507E-4, 23=0.0016439643024894317, 13=0.0019169329073482429, 14=0.002053063802905875, 15=0.0017292878478226694, 16=0.0023112480739599386, 17=0.0010695187165775401, 18=0.0020123839009287925, 19=0.0026405716060888475, 20=0.0016245753950671984, 21=0.0025594700391448357}, 2015-02-13={00=0.001145475372279496, 11=0.0012116316639741518, 22=0.0031565656565656565, 01=0.0025220680958385876, 12=0.0017059708981435023, 23=0.0012093987560469939, 02=0.0053475935828877, 13=0.0020339672531272247, 03=0.006666666666666667, 14=0.00240033395950741, 04=0.0, 15=0.0022741368616911307, 05=0.0, 16=0.001679437388474861, 06=0.0024457352491592784, 17=0.001981230448383733, 07=0.0023161551823972205, 18=0.0021929824561403508, 08=0.0021008403361344537, 19=0.002268798617113224, 09=0.0016554464187175809, 20=0.00240831964969896, 10=0.0014039310068190934, 21=0.0018464212012599109}, 2015-01-02={00=0.0027844073190135244, 11=0.0017793594306049821, 22=0.002077009106886084, 01=0.003157894736842105, 12=0.0013915463558879806, 23=0.0024691358024691358, 02=0.0, 13=0.0023423121967542245, 03=0.0, 14=0.002780049059689289, 04=0.0, 15=0.0027300465713826884, 05=0.0051813471502590676, 16=4.664904369460426E-4, 06=0.0024024024024024023, 17=0.0010790812394018807, 07=0.0010905125408942203, 18=0.001924500370096225, 08=0.0012976901116013497, 19=0.001646460110761862, 09=0.00233446519524618, 20=0.0023094688221709007, 10=0.0023508137432188066, 21=0.002241524236480807}, 2015-02-14={00=0.0019774011299435027, 11=0.002047244094488189, 22=0.0021809299485300534, 01=0.0022471910112359553, 12=0.002801774457156199, 23=8.558503484533561E-4, 02=0.0, 13=0.0019540409566984524, 03=0.0, 14=0.002239728143342601, 04=0.0, 15=0.0016119128031931225, 05=0.004, 16=0.0014649190439475714, 06=0.0012496875781054736, 17=0.002068014705882353, 07=0.002035065748278021, 18=0.001923520812495191, 08=0.0014797951052931133, 19=0.002252777130428028, 09=0.0019941043870296514, 20=0.001702918182521867, 10=0.0021330383946911043, 21=0.002928709055876686}, 2015-02-11={00=0.0018508725542041248, 11=0.002131287297527707, 22=0.0018507807981492192, 01=0.001430615164520744, 12=0.00201377848436672, 23=0.003004427577482606, 02=0.0, 13=0.0019995790359924226, 03=0.0, 14=0.0015746378332983414, 04=0.006024096385542169, 15=0.00136870920193725, 05=9.115770282588879E-4, 16=0.0017620232172470978, 06=0.001053001053001053, 17=0.001746276322547509, 07=0.0016433853738701725, 18=0.001727466720861701, 08=0.0028125, 19=0.002469898116702686, 09=0.0018102824040550326, 20=0.002028397565922921, 10=0.0018177929854576562, 21=0.0024002400240024004}, 2015-02-12={00=0.002127093858016485, 11=0.002675704602211916, 22=0.0022465325258839617, 01=0.002130681818181818, 12=0.0013646288209606986, 23=9.784735812133072E-4, 02=0.0, 13=0.0019793072424651374, 03=0.0, 14=0.0017038830598152632, 04=0.005988023952095809, 15=0.0015937666017354348, 05=7.955449482895784E-4, 16=0.001515691868758916, 06=0.002010916403332376, 17=0.0016968830936858086, 07=0.00197912918315941, 18=0.0020267888614733873, 08=0.002068787173519524, 19=0.001504424778761062, 09=0.0013379991766158913, 20=0.002563422611155308, 10=0.0022688084218168616, 21=0.0019054217910964837}, 2015-01-09={00=0.002609992542878449, 11=0.002166985340981517, 22=0.002911208151382824, 01=0.002053388090349076, 12=0.0015719151165837044, 23=0.00229147571035747, 02=0.008771929824561403, 13=0.00212624584717608, 03=0.0, 14=0.00186219739292365, 04=0.0, 15=0.0022669689291905585, 05=0.003389830508474576, 16=0.002807486631016043, 06=0.0020483408439164277, 17=0.0016664352173309262, 07=0.002780586450960566, 18=0.001385809312638581, 08=0.0012630819198845183, 19=0.0018128573420722353, 09=0.0019982871824150727, 20=0.002286367533581023, 10=0.0020504933999743688, 21=0.002008032128514056}, 2015-01-07={00=0.0013953488372093023, 11=0.002516426674122746, 22=0.0014082027812004929, 01=0.0, 12=0.0015757054863200115, 23=0.002904162633107454, 02=0.0, 13=0.002553916004540295, 03=0.0, 14=0.0018699654775604143, 04=0.0, 15=0.002050380785002929, 05=0.0, 16=0.0023686158401184307, 06=0.0017738359201773836, 17=0.0016124303723248313, 07=0.0019439044709802832, 18=0.0029775197260681853, 08=0.0015426147319706903, 19=0.001486988847583643, 09=0.0027945971122496508, 20=0.0016548819016097489, 10=0.0022563813284445073, 21=0.0019981555487242546}, 2015-02-19={00=0.001977152899824253, 11=0.0020770828525271175, 22=0.002128927871923699, 01=0.0023894862604540022, 12=0.002778612195854611, 23=0.0022455974471102705, 02=0.005128205128205128, 13=0.00196835490953138, 03=0.0, 14=0.002499431947284708, 04=0.0040650406504065045, 15=0.0018877897757305746, 05=6.684491978609625E-4, 16=0.0015363343063450607, 06=0.001430615164520744, 17=0.0022696323195642307, 07=0.0013268465280849183, 18=0.0014518224191946206, 08=0.0016474464579901153, 19=0.0020422055820285907, 09=0.0017029972752043597, 20=0.0019594543673223303, 10=0.0025749772796122387, 21=0.002514668901927913}, 2015-01-08={00=0.002003205128205128, 11=0.0023637557452396585, 22=0.0022977186935828, 01=0.0032679738562091504, 12=0.0010491803278688525, 23=0.0020174848688634837, 02=0.0, 13=0.0025132275132275133, 03=0.0, 14=0.0019549068161084323, 04=0.0, 15=0.0025252525252525255, 05=0.004524886877828055, 16=0.0017847336628226248, 06=8.216926869350862E-4, 17=0.002194486353037992, 07=0.0035052578868302454, 18=0.0026786973072042857, 08=0.0016248420292471566, 19=0.001257685858021241, 09=0.0025589991470002845, 20=0.0018447566340286648, 10=0.0027244421380384016, 21=0.002869028833739779}, 2015-02-10={00=0.0020234722784297854, 11=0.0013772918998020143, 22=0.001968048159296133, 01=5.724098454493417E-4, 12=0.0021082220660576245, 23=0.0017871649065800163, 02=0.005319148936170213, 13=0.0020428101962874146, 03=0.0, 14=0.0016201620162016202, 04=0.0, 15=0.0024757014487438106, 05=7.423904974016332E-4, 16=0.0026530052145274908, 06=0.0019094380796508457, 17=0.0016133624371263168, 07=0.0019649582446373015, 18=0.0021129466000768342, 08=0.0020032995522036297, 19=0.002336448598130841, 09=0.0018315018315018315, 20=0.0021927638791986444, 10=0.0026070137078462704, 21=0.0013160558817574407}, 2015-02-06={00=0.0029647198339756895, 11=0.0014156593705760645, 22=0.0023450586264656616, 01=0.004626060138781804, 12=0.0011637748624629708, 23=0.002527246880429632, 02=0.0, 13=0.001596763891845859, 03=0.006535947712418301, 14=0.002957642336537446, 04=0.0, 15=0.0023802131843112906, 05=0.0019011406844106464, 16=0.0021408910184524416, 06=0.002450122506125306, 17=0.002512057877813505, 07=0.001532399299474606, 18=0.002460276781137878, 08=0.0022116903633491313, 19=0.0017251877410188756, 09=0.0024021138601969735, 20=0.0018057784911717496, 10=0.002045650301464255, 21=0.0017892644135188867}, 2015-02-07={00=7.808433107756377E-4, 11=0.001723925624923039, 22=0.0023240371845949536, 01=0.0014154281670205238, 12=9.787129924149743E-4, 23=0.0016881522406384285, 02=0.006060606060606061, 13=0.0025776215582893965, 03=0.007751937984496124, 14=0.0017470300489168414, 04=0.0, 15=0.0021803117845851957, 05=0.0, 16=0.0026382323843025172, 06=4.1562759767248546E-4, 17=0.0016030779095864058, 07=0.0025799793601651187, 18=0.001978136387298282, 08=0.003141167775314117, 19=0.001224364860728497, 09=0.0021108922037714607, 20=0.002737781383086595, 10=0.0013920526449000253, 21=0.0015860428231562252}, 2015-02-04={00=0.0013080444735120995, 11=0.0029698265621287715, 22=0.002482313516197096, 01=0.002770083102493075, 12=0.00211118930330753, 23=0.0014126787921596327, 02=0.0, 13=0.0026565026565026563, 03=0.0, 14=0.0026506857208712688, 04=0.0, 15=0.002602398732744965, 05=9.891196834817012E-4, 16=0.001806480749689511, 06=0.0015349194167306216, 17=0.0018302447952413636, 07=0.0027611596870685687, 18=0.0011353315168029065, 08=0.004060226695990526, 19=0.0014819881440948472, 09=0.0015680125441003528, 20=0.0021027003098716248, 10=0.0022292619969494307, 21=0.002170138888888889}, 2015-02-05={00=0.0017211703958691911, 11=0.001912655403251514, 22=0.0021203286509408957, 01=0.0038819875776397515, 12=0.0024117518088138568, 23=0.0014727540500736377, 02=0.0, 13=0.0026702269692923898, 03=0.0, 14=0.0016316762754269552, 04=0.0064516129032258064, 15=0.0017448200654307524, 05=0.0018501387604070306, 16=0.0022504782266231575, 06=0.002019522046449007, 17=0.0032963410614218216, 07=0.0017075773745997866, 18=0.0014585437002131718, 08=0.002122498483929654, 19=0.0016962569263824494, 09=0.002817562808170932, 20=0.0019542476146683528, 10=0.0019100169779286927, 21=0.0031373460376481524}, 2015-02-02={00=0.0030876109610189118, 11=0.001786169941311559, 22=0.0011148272017837235, 01=0.0010638297872340426, 12=0.0015463917525773195, 23=0.0034873583260680036, 02=0.008, 13=0.0015932023366967605, 03=0.0, 14=0.001869158878504673, 04=0.0, 15=0.0016802378182758176, 05=0.0, 16=0.0016235962657285888, 06=0.001923816852635629, 17=0.0020134228187919465, 07=0.001975796492961225, 18=0.001355197181189863, 08=5.350454788657035E-4, 19=0.002177759629780863, 09=0.0026847534265931894, 20=0.0017921146953405018, 10=0.0024071962498416317, 21=0.0016474464579901153}, 2015-02-03={00=0.002158273381294964, 11=0.0017748853719863926, 22=0.0019569471624266144, 01=0.0029615004935834156, 12=0.0016514036931391683, 23=0.0012106537530266344, 02=0.0, 13=0.001888985759953502, 03=0.0, 14=0.0027310622394710366, 04=0.0, 15=0.0012587412587412587, 05=0.0, 16=0.0016741071428571428, 06=0.0024236548715462916, 17=0.0022087244616234127, 07=0.0014488554042306578, 18=0.0021837041080933536, 08=0.0010660980810234541, 19=0.0023116671199347296, 09=8.496176720475786E-4, 20=0.003177124702144559, 10=0.0016308376575240918, 21=0.0022330224615788783}, 2015-02-01={00=0.002738975623116954, 11=0.0015103458692040477, 22=0.0010496850944716584, 01=7.352941176470588E-4, 12=0.0018284321194575652, 23=0.0019831432821021317, 02=0.007194244604316547, 13=0.0016356877323420074, 03=0.0, 14=0.0013873901649452752, 04=0.0, 15=0.0022699757869249393, 05=0.0, 16=0.0022796352583586625, 06=0.0018433179723502304, 17=0.0019726858877086493, 07=0.0020796197266785502, 18=0.0013839766261725358, 08=0.0019693654266958426, 19=0.0016633902918493876, 09=0.002542372881355932, 20=0.0023066277102875596, 10=0.0018192844147968466, 21=0.0023988005997001498}, 2015-02-08={00=0.002783400809716599, 11=0.0018077734257306419, 22=0.001719777440566515, 01=0.0021770682148040637, 12=0.0028072989773410867, 23=0.0016764459346186086, 02=0.005494505494505495, 13=0.002153063221765512, 03=0.0, 14=0.0025159667118250435, 04=0.0, 15=0.0025405511041625955, 05=0.0026019080659150044, 16=0.002001524971406786, 06=0.0019255455712451862, 17=0.0020597322348094747, 07=0.0022316899979711907, 18=0.0012883040397533819, 08=0.001602097290999126, 19=0.0018170255292086854, 09=0.0018256503879507074, 20=0.001784280488892854, 10=0.0019019442096365174, 21=0.0018734945133374967}, 2015-02-09={00=9.378663540445487E-4, 11=0.001996340043254034, 22=0.001422981145499822, 01=6.289308176100629E-4, 12=0.0015516537362188648, 23=0.001760784806942523, 02=0.009009009009009009, 13=0.002303389272787101, 03=0.01675977653631285, 14=0.002048676554945505, 04=0.005025125628140704, 15=0.0019587039908593815, 05=0.0014825796886582653, 16=0.002659360141832541, 06=0.001638001638001638, 17=0.001521460602178091, 07=0.0016345210853220007, 18=0.001614074731660076, 08=0.001333494969087162, 19=0.0017704812489940447, 09=0.0017921146953405018, 20=0.0022389253158483927, 10=0.0017225822327946846, 21=0.0016697145583207441}}".replace("=",":")).toMap();

        DBHandler handler;

        try {
            handler = DBHandler.getDBConnection();
            handler.dropCollection("click_log");
            handler.dropCollection("impression_log");

            Parser.parseCSV(clickFile);
            Parser.parseCSV(impressionsFile);

            Map<String, Map<String, Double>> result = DBQuery.getCTROverTime();

            assertEquals("Correct Hashmap", expectedCtrMap, result);
        } catch (MongoAuthException e) {
            e.printStackTrace();
        }
    }
}
